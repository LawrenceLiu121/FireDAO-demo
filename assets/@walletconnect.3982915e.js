import{e as t}from"./events.a9b49b88.js";import{f as e}from"./cross-fetch.a0a11bb5.js";import"./is-typedarray.90714367.js";import{a as n}from"./js-sha3.5a5bea04.js";import{q as i}from"./query-string.5f3c4763.js";import{E as r}from"./eventemitter3.dc5195d7.js";import{c as o,a as s}from"./react.49c1050d.js";import{r as a}from"./keccak256.f874be79.js";import{t as h}from"./typedarray-to-buffer.cb2421e0.js";import{d as c}from"./detect-browser.04f03769.js";import{b as l}from"./qrcode.0c350149.js";import{c as u}from"./copy-to-clipboard.91f73d5f.js";import{r as d}from"./preact.73e553d5.js";const p=[-32700,-32600,-32601,-32602,-32603],m={PARSE_ERROR:{code:-32700,message:"Parse error"},INVALID_REQUEST:{code:-32600,message:"Invalid Request"},METHOD_NOT_FOUND:{code:-32601,message:"Method not found"},INVALID_PARAMS:{code:-32602,message:"Invalid params"},INTERNAL_ERROR:{code:-32603,message:"Internal error"},SERVER_ERROR:{code:-32e3,message:"Server error"}};function f(t){return Object.keys(m).includes(t)?m[t]:m.INTERNAL_ERROR}var g={},_={};function w(){return(null==o?void 0:o.crypto)||(null==o?void 0:o.msCrypto)||{}}function v(){const t=w();return t.subtle||t.webkitSubtle}Object.defineProperty(_,"__esModule",{value:!0}),_.isBrowserCryptoAvailable=_.getSubtleCrypto=_.getBrowerCrypto=void 0,_.getBrowerCrypto=w,_.getSubtleCrypto=v,_.isBrowserCryptoAvailable=function(){return!!w()&&!!v()};var y,b,M,x={};function k(){return"undefined"==typeof document&&"undefined"!=typeof navigator&&"ReactNative"===navigator.product}function S(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node}function E(){return Date.now()*Math.pow(10,3)+Math.floor(Math.random()*Math.pow(10,3))}function I(t,e){return{id:t,jsonrpc:"2.0",error:C(e)}}function C(t){return void 0===t?f("INTERNAL_ERROR"):("string"==typeof t&&(t=Object.assign(Object.assign({},f("SERVER_ERROR")),{message:t})),e=t.code,p.includes(e)&&(t=function(t){return Object.values(m).find((e=>e.code===t))||m.INTERNAL_ERROR}(t.code)),t);var e}Object.defineProperty(x,"__esModule",{value:!0}),x.isBrowser=x.isNode=x.isReactNative=void 0,x.isReactNative=k,x.isNode=S,x.isBrowser=function(){return!k()&&!S()},y=g,b=o&&o.__createBinding||(Object.create?function(t,e,n,i){void 0===i&&(i=n),Object.defineProperty(t,i,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,i){void 0===i&&(i=n),t[i]=e[n]}),M=o&&o.__exportStar||function(t,e){for(var n in t)"default"===n||e.hasOwnProperty(n)||b(e,t,n)},Object.defineProperty(y,"__esModule",{value:!0}),M(_,y),M(x,y);class R{}class O extends R{constructor(t){super()}}class q extends R{constructor(){super()}}class T extends q{constructor(t){super()}}function N(t,e){const n=function(t){const e=t.match(new RegExp(/^\w+:/,"gi"));if(e&&e.length)return e[0]}(t);return void 0!==n&&new RegExp(e).test(n)}function L(t){return N(t,"^https?:")}function A(t){return"error"in t}class j extends T{constructor(e){super(e),this.events=new t.exports.EventEmitter,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async request(t,e){return this.requestStrict((n=t.method,i=t.params||[],{id:r||E(),jsonrpc:"2.0",method:n,params:i}),e);var n,i,r}async requestStrict(t,e){return new Promise((async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(r){i(r)}this.events.on(`${t.id}`,(t=>{A(t)?i(t.error.message):n(t.result)}));try{await this.connection.send(t,e)}catch(r){i(r)}}))}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),!function(t){return function(t){return"id"in t&&"jsonrpc"in t&&"2.0"===t.jsonrpc}(t)&&(function(t){return"result"in t}(t)||A(t))}(t)?this.events.emit("message",{type:t.method,data:t.params}):this.events.emit(`${t.id}`,t)}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),"string"==typeof t&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close(),this.events.emit("disconnect")}registerEventListeners(){this.connection.on("payload",(t=>this.onPayload(t))),this.connection.on("close",(()=>this.events.emit("disconnect"))),this.connection.on("error",(t=>this.events.emit("error",t)))}}function P(t){if("string"!=typeof t)throw new Error("Cannot safe json parse value of type "+typeof t);try{return JSON.parse(t)}catch(e){return t}}function z(t){return"string"==typeof t?t:JSON.stringify(t)}const U={headers:{Accept:"application/json","Content-Type":"application/json"},method:"POST"};class B{constructor(e){if(this.url=e,this.events=new t.exports.EventEmitter,this.isAvailable=!1,this.registering=!1,!L(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t,n){this.isAvailable||await this.register();try{const n=z(t),i=await e(this.url,Object.assign(Object.assign({},U),{body:n})),r=await i.json();this.onPayload({data:r})}catch(i){this.onError(t.id,i)}}async register(t=this.url){if(!L(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering)return new Promise(((t,e)=>{this.events.once("register_error",(t=>{e(t)})),this.events.once("open",(()=>{if(void 0===this.isAvailable)return e(new Error("HTTP connection is missing or invalid"));t()}))}));this.url=t,this.registering=!0;try{const n=z({id:1,jsonrpc:"2.0",method:"test",params:[]});await e(t,Object.assign(Object.assign({},U),{body:n})),this.onOpen()}catch(n){const t=this.parseError(n);throw this.events.emit("register_error",t),this.onClose(),t}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(void 0===t.data)return;const e="string"==typeof t.data?P(t.data):t.data;this.events.emit("payload",e)}onError(t,e){const n=this.parseError(e),i=I(t,n.message||n.toString());this.events.emit("payload",i)}parseError(t,e=this.url){return function(t,e,n){return t.message.includes("getaddrinfo ENOTFOUND")||t.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${n} RPC url at ${e}`):t}(t,e,"HTTP")}}var W={},D={};Object.defineProperty(D,"__esModule",{value:!0});var $=D.getLocalStorage=D.getLocalStorageOrThrow=D.getCrypto=D.getCryptoOrThrow=D.getLocation=D.getLocationOrThrow=D.getNavigator=D.getNavigatorOrThrow=D.getDocument=D.getDocumentOrThrow=D.getFromWindowOrThrow=D.getFromWindow=void 0;function Z(t){let e;return"undefined"!=typeof window&&void 0!==window[t]&&(e=window[t]),e}var F=D.getFromWindow=Z;function Q(t){const e=Z(t);if(!e)throw new Error(`${t} is not defined in Window`);return e}var H=D.getFromWindowOrThrow=Q;var J=D.getDocumentOrThrow=function(){return Q("document")};var K=D.getDocument=function(){return Z("document")};var V=D.getNavigatorOrThrow=function(){return Q("navigator")};var Y=D.getNavigator=function(){return Z("navigator")};var G=D.getLocationOrThrow=function(){return Q("location")};var X=D.getLocation=function(){return Z("location")};var tt=D.getCryptoOrThrow=function(){return Q("crypto")};var et=D.getCrypto=function(){return Z("crypto")};var nt=D.getLocalStorageOrThrow=function(){return Q("localStorage")};$=D.getLocalStorage=function(){return Z("localStorage")},Object.defineProperty(W,"__esModule",{value:!0});var it=W.getWindowMetadata=void 0;const rt=D;function ot(t){return c(t)}function st(){const t=ot();return t&&t.os?t.os:void 0}function at(){const t=st();return!!t&&t.toLowerCase().includes("android")}function ht(){const t=st();return!!t&&(t.toLowerCase().includes("ios")||t.toLowerCase().includes("mac")&&navigator.maxTouchPoints>1)}function ct(){return!!st()&&(at()||ht())}function lt(){const t=ot();return!(!t||!t.name)&&"node"===t.name.toLowerCase()}function ut(){return!lt()&&!!_t()}it=W.getWindowMetadata=function(){let t,e;try{t=rt.getDocumentOrThrow(),e=rt.getLocationOrThrow()}catch(r){return null}function n(...e){const n=t.getElementsByTagName("meta");for(let t=0;t<n.length;t++){const i=n[t],r=["itemprop","property","name"].map((t=>i.getAttribute(t))).filter((t=>!!t&&e.includes(t)));if(r.length&&r){const t=i.getAttribute("content");if(t)return t}}return""}const i=function(){let e=n("name","og:site_name","og:title","twitter:title");return e||(e=t.title),e}();return{description:n("description","og:description","twitter:description","keywords"),url:e.origin,icons:function(){const n=t.getElementsByTagName("link"),i=[];for(let t=0;t<n.length;t++){const r=n[t],o=r.getAttribute("rel");if(o&&o.toLowerCase().indexOf("icon")>-1){const t=r.getAttribute("href");if(t)if(-1===t.toLowerCase().indexOf("https:")&&-1===t.toLowerCase().indexOf("http:")&&0!==t.indexOf("//")){let n=e.protocol+"//"+e.host;if(0===t.indexOf("/"))n+=t;else{const i=e.pathname.split("/");i.pop();n+=i.join("/")+"/"+t}i.push(n)}else if(0===t.indexOf("//")){const n=e.protocol+t;i.push(n)}else i.push(t)}}return i}(),name:i}};const dt=F,pt=H,mt=J,ft=K,gt=V,_t=Y,wt=G,vt=X,yt=tt,bt=et,Mt=nt,xt=$;function kt(){return it()}const St=P,Et=z;function It(t,e){const n=Et(e),i=xt();i&&i.setItem(t,n)}function Ct(t){let e=null,n=null;const i=xt();return i&&(n=i.getItem(t)),e=n?St(n):n,e}function Rt(t){const e=xt();e&&e.removeItem(t)}function Ot(t,e){return t.filter((t=>t.name.toLowerCase().includes(e.toLowerCase())))[0]}const qt="https://registry.walletconnect.com";function Tt(t,e="mobile"){var n;return{name:t.name||"",shortName:t.metadata.shortName||"",color:t.metadata.colors.primary||"",logo:null!==(n=t.image_url.sm)&&void 0!==n?n:"",universalLink:t[e].universal||"",deepLink:t[e].native||""}}var Nt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",detectEnv:ot,detectOS:st,isAndroid:at,isIOS:ht,isMobile:ct,isNode:lt,isBrowser:ut,getFromWindow:dt,getFromWindowOrThrow:pt,getDocumentOrThrow:mt,getDocument:ft,getNavigatorOrThrow:gt,getNavigator:_t,getLocationOrThrow:wt,getLocation:vt,getCryptoOrThrow:yt,getCrypto:bt,getLocalStorageOrThrow:Mt,getLocalStorage:xt,getClientMeta:kt,safeJsonParse:St,safeJsonStringify:Et,setLocal:It,getLocal:Ct,removeLocal:Rt,mobileLinkChoiceKey:"WALLETCONNECT_DEEPLINK_CHOICE",formatIOSMobile:function(t,e){const n=encodeURIComponent(t);return e.universalLink?`${e.universalLink}/wc?uri=${n}`:e.deepLink?`${e.deepLink}${e.deepLink.endsWith(":")?"//":"/"}wc?uri=${n}`:""},saveMobileLinkInfo:function(t){const e=t.href.split("?")[0];It("WALLETCONNECT_DEEPLINK_CHOICE",Object.assign(Object.assign({},t),{href:e}))},getMobileRegistryEntry:Ot,getMobileLinkRegistry:function(t,e){let n=t;return e&&(n=e.map((e=>Ot(t,e))).filter(Boolean)),n},getWalletRegistryUrl:function(){return qt+"/api/v2/wallets"},getDappRegistryUrl:function(){return qt+"/api/v2/dapps"},formatMobileRegistryEntry:Tt,formatMobileRegistry:function(t,e="mobile"){return Object.values(t).filter((t=>!!t[e].universal||!!t[e].native)).map((t=>Tt(t,e)))}});const Lt=["session_request","session_update","exchange_key","connect","disconnect","display_uri","modal_closed","transport_open","transport_close","transport_error"],At=["eth_sendTransaction","eth_signTransaction","eth_sign","eth_signTypedData","eth_signTypedData_v1","eth_signTypedData_v2","eth_signTypedData_v3","eth_signTypedData_v4","personal_sign","wallet_addEthereumChain","wallet_switchEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],jt={1:"mainnet",3:"ropsten",4:"rinkeby",5:"goerli",42:"kovan"};var Pt={exports:{}};!function(t,e){function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function i(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}function r(t,e,n){if(r.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(n=e,e=10),this._init(t||0,e||10,n||"be"))}var o;"object"==typeof t?t.exports=r:e.BN=r,r.BN=r,r.wordSize=26;try{o=a.Buffer}catch(k){}function s(t,e,n){for(var i=0,r=Math.min(t.length,n),o=e;o<r;o++){var s=t.charCodeAt(o)-48;i<<=4,i|=s>=49&&s<=54?s-49+10:s>=17&&s<=22?s-17+10:15&s}return i}function h(t,e,n,i){for(var r=0,o=Math.min(t.length,n),s=e;s<o;s++){var a=t.charCodeAt(s)-48;r*=i,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}r.isBN=function(t){return t instanceof r||null!==t&&"object"==typeof t&&t.constructor.wordSize===r.wordSize&&Array.isArray(t.words)},r.max=function(t,e){return t.cmp(e)>0?t:e},r.min=function(t,e){return t.cmp(e)<0?t:e},r.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var r=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&r++,16===e?this._parseHex(t,r):this._parseBase(t,e,r),"-"===t[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),e,i)},r.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},r.prototype._initArray=function(t,e,i){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var o,s,a=0;if("be"===i)for(r=t.length-1,o=0;r>=0;r-=3)s=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);else if("le"===i)for(r=0,o=0;r<t.length;r+=3)s=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[o]|=s<<a&67108863,this.words[o+1]=s>>>26-a&67108863,(a+=24)>=26&&(a-=26,o++);return this.strip()},r.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var n=0;n<this.length;n++)this.words[n]=0;var i,r,o=0;for(n=t.length-6,i=0;n>=e;n-=6)r=s(t,n,n+6),this.words[i]|=r<<o&67108863,this.words[i+1]|=r>>>26-o&4194303,(o+=24)>=26&&(o-=26,i++);n+6!==e&&(r=s(t,e,n+6),this.words[i]|=r<<o&67108863,this.words[i+1]|=r>>>26-o&4194303),this.strip()},r.prototype._parseBase=function(t,e,n){this.words=[0],this.length=1;for(var i=0,r=1;r<=67108863;r*=e)i++;i--,r=r/e|0;for(var o=t.length-n,s=o%i,a=Math.min(o,o-s)+n,c=0,l=n;l<a;l+=i)c=h(t,l,l+i,e),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==s){var u=1;for(c=h(t,l,t.length,e),l=0;l<s;l++)u*=e;this.imuln(u),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},r.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},r.prototype.clone=function(){var t=new r(null);return this.copy(t),t},r.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},r.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},r.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},r.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var c=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],l=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],u=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function d(t,e,n){n.negative=e.negative^t.negative;var i=t.length+e.length|0;n.length=i,i=i-1|0;var r=0|t.words[0],o=0|e.words[0],s=r*o,a=67108863&s,h=s/67108864|0;n.words[0]=a;for(var c=1;c<i;c++){for(var l=h>>>26,u=67108863&h,d=Math.min(c,e.length-1),p=Math.max(0,c-t.length+1);p<=d;p++){var m=c-p|0;l+=(s=(r=0|t.words[m])*(o=0|e.words[p])+u)/67108864|0,u=67108863&s}n.words[c]=0|u,h=0|l}return 0!==h?n.words[c]=0|h:n.length--,n.strip()}r.prototype.toString=function(t,e){var i;if(e=0|e||1,16===(t=t||10)||"hex"===t){i="";for(var r=0,o=0,s=0;s<this.length;s++){var a=this.words[s],h=(16777215&(a<<r|o)).toString(16);i=0!=(o=a>>>24-r&16777215)||s!==this.length-1?c[6-h.length]+h+i:h+i,(r+=2)>=26&&(r-=26,s--)}for(0!==o&&(i=o.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var d=l[t],p=u[t];i="";var m=this.clone();for(m.negative=0;!m.isZero();){var f=m.modn(p).toString(t);i=(m=m.idivn(p)).isZero()?f+i:c[d-f.length]+f+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},r.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},r.prototype.toJSON=function(){return this.toString(16)},r.prototype.toBuffer=function(t,e){return n(void 0!==o),this.toArrayLike(o,t,e)},r.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},r.prototype.toArrayLike=function(t,e,i){var r=this.byteLength(),o=i||Math.max(1,r);n(r<=o,"byte array longer than desired length"),n(o>0,"Requested array length <= 0"),this.strip();var s,a,h="le"===e,c=new t(o),l=this.clone();if(h){for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[a]=s;for(;a<o;a++)c[a]=0}else{for(a=0;a<o-r;a++)c[a]=0;for(a=0;!l.isZero();a++)s=l.andln(255),l.iushrn(8),c[o-a-1]=s}return c},Math.clz32?r.prototype._countBits=function(t){return 32-Math.clz32(t)}:r.prototype._countBits=function(t){var e=t,n=0;return e>=4096&&(n+=13,e>>>=13),e>=64&&(n+=7,e>>>=7),e>=8&&(n+=4,e>>>=4),e>=2&&(n+=2,e>>>=2),n+e},r.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,n=0;return 0==(8191&e)&&(n+=13,e>>>=13),0==(127&e)&&(n+=7,e>>>=7),0==(15&e)&&(n+=4,e>>>=4),0==(3&e)&&(n+=2,e>>>=2),0==(1&e)&&n++,n},r.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},r.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var n=this._zeroBits(this.words[e]);if(t+=n,26!==n)break}return t},r.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},r.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},r.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},r.prototype.isNeg=function(){return 0!==this.negative},r.prototype.neg=function(){return this.clone().ineg()},r.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},r.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},r.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},r.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},r.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},r.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var n=0;n<e.length;n++)this.words[n]=this.words[n]&t.words[n];return this.length=e.length,this.strip()},r.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},r.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},r.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},r.prototype.iuxor=function(t){var e,n;this.length>t.length?(e=this,n=t):(e=t,n=this);for(var i=0;i<n.length;i++)this.words[i]=e.words[i]^n.words[i];if(this!==e)for(;i<e.length;i++)this.words[i]=e.words[i];return this.length=e.length,this.strip()},r.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},r.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},r.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},r.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var r=0;r<e;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},r.prototype.notn=function(t){return this.clone().inotn(t)},r.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var i=t/26|0,r=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},r.prototype.iadd=function(t){var e,n,i;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();this.length>t.length?(n=this,i=t):(n=t,i=this);for(var r=0,o=0;o<i.length;o++)e=(0|n.words[o])+(0|i.words[o])+r,this.words[o]=67108863&e,r=e>>>26;for(;0!==r&&o<n.length;o++)e=(0|n.words[o])+r,this.words[o]=67108863&e,r=e>>>26;if(this.length=n.length,0!==r)this.words[this.length]=r,this.length++;else if(n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this},r.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},r.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var n,i,r=this.cmp(t);if(0===r)return this.negative=0,this.length=1,this.words[0]=0,this;r>0?(n=this,i=t):(n=t,i=this);for(var o=0,s=0;s<i.length;s++)o=(e=(0|n.words[s])-(0|i.words[s])+o)>>26,this.words[s]=67108863&e;for(;0!==o&&s<n.length;s++)o=(e=(0|n.words[s])+o)>>26,this.words[s]=67108863&e;if(0===o&&s<n.length&&n!==this)for(;s<n.length;s++)this.words[s]=n.words[s];return this.length=Math.max(this.length,s),n!==this&&(this.negative=1),this.strip()},r.prototype.sub=function(t){return this.clone().isub(t)};var p=function(t,e,n){var i,r,o,s=t.words,a=e.words,h=n.words,c=0,l=0|s[0],u=8191&l,d=l>>>13,p=0|s[1],m=8191&p,f=p>>>13,g=0|s[2],_=8191&g,w=g>>>13,v=0|s[3],y=8191&v,b=v>>>13,M=0|s[4],x=8191&M,k=M>>>13,S=0|s[5],E=8191&S,I=S>>>13,C=0|s[6],R=8191&C,O=C>>>13,q=0|s[7],T=8191&q,N=q>>>13,L=0|s[8],A=8191&L,j=L>>>13,P=0|s[9],z=8191&P,U=P>>>13,B=0|a[0],W=8191&B,D=B>>>13,$=0|a[1],Z=8191&$,F=$>>>13,Q=0|a[2],H=8191&Q,J=Q>>>13,K=0|a[3],V=8191&K,Y=K>>>13,G=0|a[4],X=8191&G,tt=G>>>13,et=0|a[5],nt=8191&et,it=et>>>13,rt=0|a[6],ot=8191&rt,st=rt>>>13,at=0|a[7],ht=8191&at,ct=at>>>13,lt=0|a[8],ut=8191&lt,dt=lt>>>13,pt=0|a[9],mt=8191&pt,ft=pt>>>13;n.negative=t.negative^e.negative,n.length=19;var gt=(c+(i=Math.imul(u,W))|0)+((8191&(r=(r=Math.imul(u,D))+Math.imul(d,W)|0))<<13)|0;c=((o=Math.imul(d,D))+(r>>>13)|0)+(gt>>>26)|0,gt&=67108863,i=Math.imul(m,W),r=(r=Math.imul(m,D))+Math.imul(f,W)|0,o=Math.imul(f,D);var _t=(c+(i=i+Math.imul(u,Z)|0)|0)+((8191&(r=(r=r+Math.imul(u,F)|0)+Math.imul(d,Z)|0))<<13)|0;c=((o=o+Math.imul(d,F)|0)+(r>>>13)|0)+(_t>>>26)|0,_t&=67108863,i=Math.imul(_,W),r=(r=Math.imul(_,D))+Math.imul(w,W)|0,o=Math.imul(w,D),i=i+Math.imul(m,Z)|0,r=(r=r+Math.imul(m,F)|0)+Math.imul(f,Z)|0,o=o+Math.imul(f,F)|0;var wt=(c+(i=i+Math.imul(u,H)|0)|0)+((8191&(r=(r=r+Math.imul(u,J)|0)+Math.imul(d,H)|0))<<13)|0;c=((o=o+Math.imul(d,J)|0)+(r>>>13)|0)+(wt>>>26)|0,wt&=67108863,i=Math.imul(y,W),r=(r=Math.imul(y,D))+Math.imul(b,W)|0,o=Math.imul(b,D),i=i+Math.imul(_,Z)|0,r=(r=r+Math.imul(_,F)|0)+Math.imul(w,Z)|0,o=o+Math.imul(w,F)|0,i=i+Math.imul(m,H)|0,r=(r=r+Math.imul(m,J)|0)+Math.imul(f,H)|0,o=o+Math.imul(f,J)|0;var vt=(c+(i=i+Math.imul(u,V)|0)|0)+((8191&(r=(r=r+Math.imul(u,Y)|0)+Math.imul(d,V)|0))<<13)|0;c=((o=o+Math.imul(d,Y)|0)+(r>>>13)|0)+(vt>>>26)|0,vt&=67108863,i=Math.imul(x,W),r=(r=Math.imul(x,D))+Math.imul(k,W)|0,o=Math.imul(k,D),i=i+Math.imul(y,Z)|0,r=(r=r+Math.imul(y,F)|0)+Math.imul(b,Z)|0,o=o+Math.imul(b,F)|0,i=i+Math.imul(_,H)|0,r=(r=r+Math.imul(_,J)|0)+Math.imul(w,H)|0,o=o+Math.imul(w,J)|0,i=i+Math.imul(m,V)|0,r=(r=r+Math.imul(m,Y)|0)+Math.imul(f,V)|0,o=o+Math.imul(f,Y)|0;var yt=(c+(i=i+Math.imul(u,X)|0)|0)+((8191&(r=(r=r+Math.imul(u,tt)|0)+Math.imul(d,X)|0))<<13)|0;c=((o=o+Math.imul(d,tt)|0)+(r>>>13)|0)+(yt>>>26)|0,yt&=67108863,i=Math.imul(E,W),r=(r=Math.imul(E,D))+Math.imul(I,W)|0,o=Math.imul(I,D),i=i+Math.imul(x,Z)|0,r=(r=r+Math.imul(x,F)|0)+Math.imul(k,Z)|0,o=o+Math.imul(k,F)|0,i=i+Math.imul(y,H)|0,r=(r=r+Math.imul(y,J)|0)+Math.imul(b,H)|0,o=o+Math.imul(b,J)|0,i=i+Math.imul(_,V)|0,r=(r=r+Math.imul(_,Y)|0)+Math.imul(w,V)|0,o=o+Math.imul(w,Y)|0,i=i+Math.imul(m,X)|0,r=(r=r+Math.imul(m,tt)|0)+Math.imul(f,X)|0,o=o+Math.imul(f,tt)|0;var bt=(c+(i=i+Math.imul(u,nt)|0)|0)+((8191&(r=(r=r+Math.imul(u,it)|0)+Math.imul(d,nt)|0))<<13)|0;c=((o=o+Math.imul(d,it)|0)+(r>>>13)|0)+(bt>>>26)|0,bt&=67108863,i=Math.imul(R,W),r=(r=Math.imul(R,D))+Math.imul(O,W)|0,o=Math.imul(O,D),i=i+Math.imul(E,Z)|0,r=(r=r+Math.imul(E,F)|0)+Math.imul(I,Z)|0,o=o+Math.imul(I,F)|0,i=i+Math.imul(x,H)|0,r=(r=r+Math.imul(x,J)|0)+Math.imul(k,H)|0,o=o+Math.imul(k,J)|0,i=i+Math.imul(y,V)|0,r=(r=r+Math.imul(y,Y)|0)+Math.imul(b,V)|0,o=o+Math.imul(b,Y)|0,i=i+Math.imul(_,X)|0,r=(r=r+Math.imul(_,tt)|0)+Math.imul(w,X)|0,o=o+Math.imul(w,tt)|0,i=i+Math.imul(m,nt)|0,r=(r=r+Math.imul(m,it)|0)+Math.imul(f,nt)|0,o=o+Math.imul(f,it)|0;var Mt=(c+(i=i+Math.imul(u,ot)|0)|0)+((8191&(r=(r=r+Math.imul(u,st)|0)+Math.imul(d,ot)|0))<<13)|0;c=((o=o+Math.imul(d,st)|0)+(r>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,i=Math.imul(T,W),r=(r=Math.imul(T,D))+Math.imul(N,W)|0,o=Math.imul(N,D),i=i+Math.imul(R,Z)|0,r=(r=r+Math.imul(R,F)|0)+Math.imul(O,Z)|0,o=o+Math.imul(O,F)|0,i=i+Math.imul(E,H)|0,r=(r=r+Math.imul(E,J)|0)+Math.imul(I,H)|0,o=o+Math.imul(I,J)|0,i=i+Math.imul(x,V)|0,r=(r=r+Math.imul(x,Y)|0)+Math.imul(k,V)|0,o=o+Math.imul(k,Y)|0,i=i+Math.imul(y,X)|0,r=(r=r+Math.imul(y,tt)|0)+Math.imul(b,X)|0,o=o+Math.imul(b,tt)|0,i=i+Math.imul(_,nt)|0,r=(r=r+Math.imul(_,it)|0)+Math.imul(w,nt)|0,o=o+Math.imul(w,it)|0,i=i+Math.imul(m,ot)|0,r=(r=r+Math.imul(m,st)|0)+Math.imul(f,ot)|0,o=o+Math.imul(f,st)|0;var xt=(c+(i=i+Math.imul(u,ht)|0)|0)+((8191&(r=(r=r+Math.imul(u,ct)|0)+Math.imul(d,ht)|0))<<13)|0;c=((o=o+Math.imul(d,ct)|0)+(r>>>13)|0)+(xt>>>26)|0,xt&=67108863,i=Math.imul(A,W),r=(r=Math.imul(A,D))+Math.imul(j,W)|0,o=Math.imul(j,D),i=i+Math.imul(T,Z)|0,r=(r=r+Math.imul(T,F)|0)+Math.imul(N,Z)|0,o=o+Math.imul(N,F)|0,i=i+Math.imul(R,H)|0,r=(r=r+Math.imul(R,J)|0)+Math.imul(O,H)|0,o=o+Math.imul(O,J)|0,i=i+Math.imul(E,V)|0,r=(r=r+Math.imul(E,Y)|0)+Math.imul(I,V)|0,o=o+Math.imul(I,Y)|0,i=i+Math.imul(x,X)|0,r=(r=r+Math.imul(x,tt)|0)+Math.imul(k,X)|0,o=o+Math.imul(k,tt)|0,i=i+Math.imul(y,nt)|0,r=(r=r+Math.imul(y,it)|0)+Math.imul(b,nt)|0,o=o+Math.imul(b,it)|0,i=i+Math.imul(_,ot)|0,r=(r=r+Math.imul(_,st)|0)+Math.imul(w,ot)|0,o=o+Math.imul(w,st)|0,i=i+Math.imul(m,ht)|0,r=(r=r+Math.imul(m,ct)|0)+Math.imul(f,ht)|0,o=o+Math.imul(f,ct)|0;var kt=(c+(i=i+Math.imul(u,ut)|0)|0)+((8191&(r=(r=r+Math.imul(u,dt)|0)+Math.imul(d,ut)|0))<<13)|0;c=((o=o+Math.imul(d,dt)|0)+(r>>>13)|0)+(kt>>>26)|0,kt&=67108863,i=Math.imul(z,W),r=(r=Math.imul(z,D))+Math.imul(U,W)|0,o=Math.imul(U,D),i=i+Math.imul(A,Z)|0,r=(r=r+Math.imul(A,F)|0)+Math.imul(j,Z)|0,o=o+Math.imul(j,F)|0,i=i+Math.imul(T,H)|0,r=(r=r+Math.imul(T,J)|0)+Math.imul(N,H)|0,o=o+Math.imul(N,J)|0,i=i+Math.imul(R,V)|0,r=(r=r+Math.imul(R,Y)|0)+Math.imul(O,V)|0,o=o+Math.imul(O,Y)|0,i=i+Math.imul(E,X)|0,r=(r=r+Math.imul(E,tt)|0)+Math.imul(I,X)|0,o=o+Math.imul(I,tt)|0,i=i+Math.imul(x,nt)|0,r=(r=r+Math.imul(x,it)|0)+Math.imul(k,nt)|0,o=o+Math.imul(k,it)|0,i=i+Math.imul(y,ot)|0,r=(r=r+Math.imul(y,st)|0)+Math.imul(b,ot)|0,o=o+Math.imul(b,st)|0,i=i+Math.imul(_,ht)|0,r=(r=r+Math.imul(_,ct)|0)+Math.imul(w,ht)|0,o=o+Math.imul(w,ct)|0,i=i+Math.imul(m,ut)|0,r=(r=r+Math.imul(m,dt)|0)+Math.imul(f,ut)|0,o=o+Math.imul(f,dt)|0;var St=(c+(i=i+Math.imul(u,mt)|0)|0)+((8191&(r=(r=r+Math.imul(u,ft)|0)+Math.imul(d,mt)|0))<<13)|0;c=((o=o+Math.imul(d,ft)|0)+(r>>>13)|0)+(St>>>26)|0,St&=67108863,i=Math.imul(z,Z),r=(r=Math.imul(z,F))+Math.imul(U,Z)|0,o=Math.imul(U,F),i=i+Math.imul(A,H)|0,r=(r=r+Math.imul(A,J)|0)+Math.imul(j,H)|0,o=o+Math.imul(j,J)|0,i=i+Math.imul(T,V)|0,r=(r=r+Math.imul(T,Y)|0)+Math.imul(N,V)|0,o=o+Math.imul(N,Y)|0,i=i+Math.imul(R,X)|0,r=(r=r+Math.imul(R,tt)|0)+Math.imul(O,X)|0,o=o+Math.imul(O,tt)|0,i=i+Math.imul(E,nt)|0,r=(r=r+Math.imul(E,it)|0)+Math.imul(I,nt)|0,o=o+Math.imul(I,it)|0,i=i+Math.imul(x,ot)|0,r=(r=r+Math.imul(x,st)|0)+Math.imul(k,ot)|0,o=o+Math.imul(k,st)|0,i=i+Math.imul(y,ht)|0,r=(r=r+Math.imul(y,ct)|0)+Math.imul(b,ht)|0,o=o+Math.imul(b,ct)|0,i=i+Math.imul(_,ut)|0,r=(r=r+Math.imul(_,dt)|0)+Math.imul(w,ut)|0,o=o+Math.imul(w,dt)|0;var Et=(c+(i=i+Math.imul(m,mt)|0)|0)+((8191&(r=(r=r+Math.imul(m,ft)|0)+Math.imul(f,mt)|0))<<13)|0;c=((o=o+Math.imul(f,ft)|0)+(r>>>13)|0)+(Et>>>26)|0,Et&=67108863,i=Math.imul(z,H),r=(r=Math.imul(z,J))+Math.imul(U,H)|0,o=Math.imul(U,J),i=i+Math.imul(A,V)|0,r=(r=r+Math.imul(A,Y)|0)+Math.imul(j,V)|0,o=o+Math.imul(j,Y)|0,i=i+Math.imul(T,X)|0,r=(r=r+Math.imul(T,tt)|0)+Math.imul(N,X)|0,o=o+Math.imul(N,tt)|0,i=i+Math.imul(R,nt)|0,r=(r=r+Math.imul(R,it)|0)+Math.imul(O,nt)|0,o=o+Math.imul(O,it)|0,i=i+Math.imul(E,ot)|0,r=(r=r+Math.imul(E,st)|0)+Math.imul(I,ot)|0,o=o+Math.imul(I,st)|0,i=i+Math.imul(x,ht)|0,r=(r=r+Math.imul(x,ct)|0)+Math.imul(k,ht)|0,o=o+Math.imul(k,ct)|0,i=i+Math.imul(y,ut)|0,r=(r=r+Math.imul(y,dt)|0)+Math.imul(b,ut)|0,o=o+Math.imul(b,dt)|0;var It=(c+(i=i+Math.imul(_,mt)|0)|0)+((8191&(r=(r=r+Math.imul(_,ft)|0)+Math.imul(w,mt)|0))<<13)|0;c=((o=o+Math.imul(w,ft)|0)+(r>>>13)|0)+(It>>>26)|0,It&=67108863,i=Math.imul(z,V),r=(r=Math.imul(z,Y))+Math.imul(U,V)|0,o=Math.imul(U,Y),i=i+Math.imul(A,X)|0,r=(r=r+Math.imul(A,tt)|0)+Math.imul(j,X)|0,o=o+Math.imul(j,tt)|0,i=i+Math.imul(T,nt)|0,r=(r=r+Math.imul(T,it)|0)+Math.imul(N,nt)|0,o=o+Math.imul(N,it)|0,i=i+Math.imul(R,ot)|0,r=(r=r+Math.imul(R,st)|0)+Math.imul(O,ot)|0,o=o+Math.imul(O,st)|0,i=i+Math.imul(E,ht)|0,r=(r=r+Math.imul(E,ct)|0)+Math.imul(I,ht)|0,o=o+Math.imul(I,ct)|0,i=i+Math.imul(x,ut)|0,r=(r=r+Math.imul(x,dt)|0)+Math.imul(k,ut)|0,o=o+Math.imul(k,dt)|0;var Ct=(c+(i=i+Math.imul(y,mt)|0)|0)+((8191&(r=(r=r+Math.imul(y,ft)|0)+Math.imul(b,mt)|0))<<13)|0;c=((o=o+Math.imul(b,ft)|0)+(r>>>13)|0)+(Ct>>>26)|0,Ct&=67108863,i=Math.imul(z,X),r=(r=Math.imul(z,tt))+Math.imul(U,X)|0,o=Math.imul(U,tt),i=i+Math.imul(A,nt)|0,r=(r=r+Math.imul(A,it)|0)+Math.imul(j,nt)|0,o=o+Math.imul(j,it)|0,i=i+Math.imul(T,ot)|0,r=(r=r+Math.imul(T,st)|0)+Math.imul(N,ot)|0,o=o+Math.imul(N,st)|0,i=i+Math.imul(R,ht)|0,r=(r=r+Math.imul(R,ct)|0)+Math.imul(O,ht)|0,o=o+Math.imul(O,ct)|0,i=i+Math.imul(E,ut)|0,r=(r=r+Math.imul(E,dt)|0)+Math.imul(I,ut)|0,o=o+Math.imul(I,dt)|0;var Rt=(c+(i=i+Math.imul(x,mt)|0)|0)+((8191&(r=(r=r+Math.imul(x,ft)|0)+Math.imul(k,mt)|0))<<13)|0;c=((o=o+Math.imul(k,ft)|0)+(r>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,i=Math.imul(z,nt),r=(r=Math.imul(z,it))+Math.imul(U,nt)|0,o=Math.imul(U,it),i=i+Math.imul(A,ot)|0,r=(r=r+Math.imul(A,st)|0)+Math.imul(j,ot)|0,o=o+Math.imul(j,st)|0,i=i+Math.imul(T,ht)|0,r=(r=r+Math.imul(T,ct)|0)+Math.imul(N,ht)|0,o=o+Math.imul(N,ct)|0,i=i+Math.imul(R,ut)|0,r=(r=r+Math.imul(R,dt)|0)+Math.imul(O,ut)|0,o=o+Math.imul(O,dt)|0;var Ot=(c+(i=i+Math.imul(E,mt)|0)|0)+((8191&(r=(r=r+Math.imul(E,ft)|0)+Math.imul(I,mt)|0))<<13)|0;c=((o=o+Math.imul(I,ft)|0)+(r>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,i=Math.imul(z,ot),r=(r=Math.imul(z,st))+Math.imul(U,ot)|0,o=Math.imul(U,st),i=i+Math.imul(A,ht)|0,r=(r=r+Math.imul(A,ct)|0)+Math.imul(j,ht)|0,o=o+Math.imul(j,ct)|0,i=i+Math.imul(T,ut)|0,r=(r=r+Math.imul(T,dt)|0)+Math.imul(N,ut)|0,o=o+Math.imul(N,dt)|0;var qt=(c+(i=i+Math.imul(R,mt)|0)|0)+((8191&(r=(r=r+Math.imul(R,ft)|0)+Math.imul(O,mt)|0))<<13)|0;c=((o=o+Math.imul(O,ft)|0)+(r>>>13)|0)+(qt>>>26)|0,qt&=67108863,i=Math.imul(z,ht),r=(r=Math.imul(z,ct))+Math.imul(U,ht)|0,o=Math.imul(U,ct),i=i+Math.imul(A,ut)|0,r=(r=r+Math.imul(A,dt)|0)+Math.imul(j,ut)|0,o=o+Math.imul(j,dt)|0;var Tt=(c+(i=i+Math.imul(T,mt)|0)|0)+((8191&(r=(r=r+Math.imul(T,ft)|0)+Math.imul(N,mt)|0))<<13)|0;c=((o=o+Math.imul(N,ft)|0)+(r>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,i=Math.imul(z,ut),r=(r=Math.imul(z,dt))+Math.imul(U,ut)|0,o=Math.imul(U,dt);var Nt=(c+(i=i+Math.imul(A,mt)|0)|0)+((8191&(r=(r=r+Math.imul(A,ft)|0)+Math.imul(j,mt)|0))<<13)|0;c=((o=o+Math.imul(j,ft)|0)+(r>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var Lt=(c+(i=Math.imul(z,mt))|0)+((8191&(r=(r=Math.imul(z,ft))+Math.imul(U,mt)|0))<<13)|0;return c=((o=Math.imul(U,ft))+(r>>>13)|0)+(Lt>>>26)|0,Lt&=67108863,h[0]=gt,h[1]=_t,h[2]=wt,h[3]=vt,h[4]=yt,h[5]=bt,h[6]=Mt,h[7]=xt,h[8]=kt,h[9]=St,h[10]=Et,h[11]=It,h[12]=Ct,h[13]=Rt,h[14]=Ot,h[15]=qt,h[16]=Tt,h[17]=Nt,h[18]=Lt,0!==c&&(h[19]=c,n.length++),n};function m(t,e,n){return(new f).mulp(t,e,n)}function f(t,e){this.x=t,this.y=e}Math.imul||(p=d),r.prototype.mulTo=function(t,e){var n=this.length+t.length;return 10===this.length&&10===t.length?p(this,t,e):n<63?d(this,t,e):n<1024?function(t,e,n){n.negative=e.negative^t.negative,n.length=t.length+e.length;for(var i=0,r=0,o=0;o<n.length-1;o++){var s=r;r=0;for(var a=67108863&i,h=Math.min(o,e.length-1),c=Math.max(0,o-t.length+1);c<=h;c++){var l=o-c,u=(0|t.words[l])*(0|e.words[c]),d=67108863&u;a=67108863&(d=d+a|0),r+=(s=(s=s+(u/67108864|0)|0)+(d>>>26)|0)>>>26,s&=67108863}n.words[o]=a,i=s,s=r}return 0!==i?n.words[o]=i:n.length--,n.strip()}(this,t,e):m(this,t,e)},f.prototype.makeRBT=function(t){for(var e=new Array(t),n=r.prototype._countBits(t)-1,i=0;i<t;i++)e[i]=this.revBin(i,n,t);return e},f.prototype.revBin=function(t,e,n){if(0===t||t===n-1)return t;for(var i=0,r=0;r<e;r++)i|=(1&t)<<e-r-1,t>>=1;return i},f.prototype.permute=function(t,e,n,i,r,o){for(var s=0;s<o;s++)i[s]=e[t[s]],r[s]=n[t[s]]},f.prototype.transform=function(t,e,n,i,r,o){this.permute(o,t,e,n,i,r);for(var s=1;s<r;s<<=1)for(var a=s<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),l=0;l<r;l+=a)for(var u=h,d=c,p=0;p<s;p++){var m=n[l+p],f=i[l+p],g=n[l+p+s],_=i[l+p+s],w=u*g-d*_;_=u*_+d*g,g=w,n[l+p]=m+g,i[l+p]=f+_,n[l+p+s]=m-g,i[l+p+s]=f-_,p!==a&&(w=h*u-c*d,d=h*d+c*u,u=w)}},f.prototype.guessLen13b=function(t,e){var n=1|Math.max(e,t),i=1&n,r=0;for(n=n/2|0;n;n>>>=1)r++;return 1<<r+1+i},f.prototype.conjugate=function(t,e,n){if(!(n<=1))for(var i=0;i<n/2;i++){var r=t[i];t[i]=t[n-i-1],t[n-i-1]=r,r=e[i],e[i]=-e[n-i-1],e[n-i-1]=-r}},f.prototype.normalize13b=function(t,e){for(var n=0,i=0;i<e/2;i++){var r=8192*Math.round(t[2*i+1]/e)+Math.round(t[2*i]/e)+n;t[i]=67108863&r,n=r<67108864?0:r/67108864|0}return t},f.prototype.convert13b=function(t,e,i,r){for(var o=0,s=0;s<e;s++)o+=0|t[s],i[2*s]=8191&o,o>>>=13,i[2*s+1]=8191&o,o>>>=13;for(s=2*e;s<r;++s)i[s]=0;n(0===o),n(0==(-8192&o))},f.prototype.stub=function(t){for(var e=new Array(t),n=0;n<t;n++)e[n]=0;return e},f.prototype.mulp=function(t,e,n){var i=2*this.guessLen13b(t.length,e.length),r=this.makeRBT(i),o=this.stub(i),s=new Array(i),a=new Array(i),h=new Array(i),c=new Array(i),l=new Array(i),u=new Array(i),d=n.words;d.length=i,this.convert13b(t.words,t.length,s,i),this.convert13b(e.words,e.length,c,i),this.transform(s,o,a,h,i,r),this.transform(c,o,l,u,i,r);for(var p=0;p<i;p++){var m=a[p]*l[p]-h[p]*u[p];h[p]=a[p]*u[p]+h[p]*l[p],a[p]=m}return this.conjugate(a,h,i),this.transform(a,h,d,o,i,r),this.conjugate(d,o,i),this.normalize13b(d,i),n.negative=t.negative^e.negative,n.length=t.length+e.length,n.strip()},r.prototype.mul=function(t){var e=new r(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},r.prototype.mulf=function(t){var e=new r(null);return e.words=new Array(this.length+t.length),m(this,t,e)},r.prototype.imul=function(t){return this.clone().mulTo(t,this)},r.prototype.imuln=function(t){n("number"==typeof t),n(t<67108864);for(var e=0,i=0;i<this.length;i++){var r=(0|this.words[i])*t,o=(67108863&r)+(67108863&e);e>>=26,e+=r/67108864|0,e+=o>>>26,this.words[i]=67108863&o}return 0!==e&&(this.words[i]=e,this.length++),this},r.prototype.muln=function(t){return this.clone().imuln(t)},r.prototype.sqr=function(){return this.mul(this)},r.prototype.isqr=function(){return this.imul(this.clone())},r.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),n=0;n<e.length;n++){var i=n/26|0,r=n%26;e[n]=(t.words[i]&1<<r)>>>r}return e}(t);if(0===e.length)return new r(1);for(var n=this,i=0;i<e.length&&0===e[i];i++,n=n.sqr());if(++i<e.length)for(var o=n.sqr();i<e.length;i++,o=o.sqr())0!==e[i]&&(n=n.mul(o));return n},r.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,i=t%26,r=(t-i)/26,o=67108863>>>26-i<<26-i;if(0!==i){var s=0;for(e=0;e<this.length;e++){var a=this.words[e]&o,h=(0|this.words[e])-a<<i;this.words[e]=h|s,s=a>>>26-i}s&&(this.words[e]=s,this.length++)}if(0!==r){for(e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(e=0;e<r;e++)this.words[e]=0;this.length+=r}return this.strip()},r.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},r.prototype.iushrn=function(t,e,i){var r;n("number"==typeof t&&t>=0),r=e?(e-e%26)/26:0;var o=t%26,s=Math.min((t-o)/26,this.length),a=67108863^67108863>>>o<<o,h=i;if(r-=s,r=Math.max(0,r),h){for(var c=0;c<s;c++)h.words[c]=this.words[c];h.length=s}if(0===s);else if(this.length>s)for(this.length-=s,c=0;c<this.length;c++)this.words[c]=this.words[c+s];else this.words[0]=0,this.length=1;var l=0;for(c=this.length-1;c>=0&&(0!==l||c>=r);c--){var u=0|this.words[c];this.words[c]=l<<26-o|u>>>o,l=u&a}return h&&0!==l&&(h.words[h.length++]=l),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},r.prototype.ishrn=function(t,e,i){return n(0===this.negative),this.iushrn(t,e,i)},r.prototype.shln=function(t){return this.clone().ishln(t)},r.prototype.ushln=function(t){return this.clone().iushln(t)},r.prototype.shrn=function(t){return this.clone().ishrn(t)},r.prototype.ushrn=function(t){return this.clone().iushrn(t)},r.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,r=1<<e;return!(this.length<=i||!(this.words[i]&r))},r.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var r=67108863^67108863>>>e<<e;this.words[this.length-1]&=r}return this.strip()},r.prototype.maskn=function(t){return this.clone().imaskn(t)},r.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},r.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},r.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},r.prototype.addn=function(t){return this.clone().iaddn(t)},r.prototype.subn=function(t){return this.clone().isubn(t)},r.prototype.iabs=function(){return this.negative=0,this},r.prototype.abs=function(){return this.clone().iabs()},r.prototype._ishlnsubmul=function(t,e,i){var r,o,s=t.length+i;this._expand(s);var a=0;for(r=0;r<t.length;r++){o=(0|this.words[r+i])+a;var h=(0|t.words[r])*e;a=((o-=67108863&h)>>26)-(h/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},r.prototype._wordDiv=function(t,e){var n=(this.length,t.length),i=this.clone(),o=t,s=0|o.words[o.length-1];0!=(n=26-this._countBits(s))&&(o=o.ushln(n),i.iushln(n),s=0|o.words[o.length-1]);var a,h=i.length-o.length;if("mod"!==e){(a=new r(null)).length=h+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var l=i.clone()._ishlnsubmul(o,1,h);0===l.negative&&(i=l,a&&(a.words[h]=1));for(var u=h-1;u>=0;u--){var d=67108864*(0|i.words[o.length+u])+(0|i.words[o.length+u-1]);for(d=Math.min(d/s|0,67108863),i._ishlnsubmul(o,d,u);0!==i.negative;)d--,i.negative=0,i._ishlnsubmul(o,1,u),i.isZero()||(i.negative^=1);a&&(a.words[u]=d)}return a&&a.strip(),i.strip(),"div"!==e&&0!==n&&i.iushrn(n),{div:a||null,mod:i}},r.prototype.divmod=function(t,e,i){return n(!t.isZero()),this.isZero()?{div:new r(0),mod:new r(0)}:0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(o=a.div.neg()),"div"!==e&&(s=a.mod.neg(),i&&0!==s.negative&&s.iadd(t)),{div:o,mod:s}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(o=a.div.neg()),{div:o,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(s=a.mod.neg(),i&&0!==s.negative&&s.isub(t)),{div:a.div,mod:s}):t.length>this.length||this.cmp(t)<0?{div:new r(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new r(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new r(this.modn(t.words[0]))}:this._wordDiv(t,e);var o,s,a},r.prototype.div=function(t){return this.divmod(t,"div",!1).div},r.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},r.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},r.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var n=0!==e.div.negative?e.mod.isub(t):e.mod,i=t.ushrn(1),r=t.andln(1),o=n.cmp(i);return o<0||1===r&&0===o?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},r.prototype.modn=function(t){n(t<=67108863);for(var e=(1<<26)%t,i=0,r=this.length-1;r>=0;r--)i=(e*i+(0|this.words[r]))%t;return i},r.prototype.idivn=function(t){n(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*e;this.words[i]=r/t|0,e=r%t}return this.strip()},r.prototype.divn=function(t){return this.clone().idivn(t)},r.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var o=new r(1),s=new r(0),a=new r(0),h=new r(1),c=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++c;for(var l=i.clone(),u=e.clone();!e.isZero();){for(var d=0,p=1;0==(e.words[0]&p)&&d<26;++d,p<<=1);if(d>0)for(e.iushrn(d);d-- >0;)(o.isOdd()||s.isOdd())&&(o.iadd(l),s.isub(u)),o.iushrn(1),s.iushrn(1);for(var m=0,f=1;0==(i.words[0]&f)&&m<26;++m,f<<=1);if(m>0)for(i.iushrn(m);m-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(l),h.isub(u)),a.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),o.isub(a),s.isub(h)):(i.isub(e),a.isub(o),h.isub(s))}return{a:a,b:h,gcd:i.iushln(c)}},r.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var o,s=new r(1),a=new r(0),h=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var c=0,l=1;0==(e.words[0]&l)&&c<26;++c,l<<=1);if(c>0)for(e.iushrn(c);c-- >0;)s.isOdd()&&s.iadd(h),s.iushrn(1);for(var u=0,d=1;0==(i.words[0]&d)&&u<26;++u,d<<=1);if(u>0)for(i.iushrn(u);u-- >0;)a.isOdd()&&a.iadd(h),a.iushrn(1);e.cmp(i)>=0?(e.isub(i),s.isub(a)):(i.isub(e),a.isub(s))}return(o=0===e.cmpn(1)?s:a).cmpn(0)<0&&o.iadd(t),o},r.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),n=t.clone();e.negative=0,n.negative=0;for(var i=0;e.isEven()&&n.isEven();i++)e.iushrn(1),n.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;n.isEven();)n.iushrn(1);var r=e.cmp(n);if(r<0){var o=e;e=n,n=o}else if(0===r||0===n.cmpn(1))break;e.isub(n)}return n.iushln(i)},r.prototype.invm=function(t){return this.egcd(t).a.umod(t)},r.prototype.isEven=function(){return 0==(1&this.words[0])},r.prototype.isOdd=function(){return 1==(1&this.words[0])},r.prototype.andln=function(t){return this.words[0]&t},r.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,i=(t-e)/26,r=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var o=r,s=i;0!==o&&s<this.length;s++){var a=0|this.words[s];o=(a+=o)>>>26,a&=67108863,this.words[s]=a}return 0!==o&&(this.words[s]=o,this.length++),this},r.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},r.prototype.cmpn=function(t){var e,i=t<0;if(0!==this.negative&&!i)return-1;if(0===this.negative&&i)return 1;if(this.strip(),this.length>1)e=1;else{i&&(t=-t),n(t<=67108863,"Number is too big");var r=0|this.words[0];e=r===t?0:r<t?-1:1}return 0!==this.negative?0|-e:e},r.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},r.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,n=this.length-1;n>=0;n--){var i=0|this.words[n],r=0|t.words[n];if(i!==r){i<r?e=-1:i>r&&(e=1);break}}return e},r.prototype.gtn=function(t){return 1===this.cmpn(t)},r.prototype.gt=function(t){return 1===this.cmp(t)},r.prototype.gten=function(t){return this.cmpn(t)>=0},r.prototype.gte=function(t){return this.cmp(t)>=0},r.prototype.ltn=function(t){return-1===this.cmpn(t)},r.prototype.lt=function(t){return-1===this.cmp(t)},r.prototype.lten=function(t){return this.cmpn(t)<=0},r.prototype.lte=function(t){return this.cmp(t)<=0},r.prototype.eqn=function(t){return 0===this.cmpn(t)},r.prototype.eq=function(t){return 0===this.cmp(t)},r.red=function(t){return new M(t)},r.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},r.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},r.prototype._forceRed=function(t){return this.red=t,this},r.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},r.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},r.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},r.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},r.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},r.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},r.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},r.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},r.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},r.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},r.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},r.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},r.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},r.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var g={k256:null,p224:null,p192:null,p25519:null};function _(t,e){this.name=t,this.p=new r(e,16),this.n=this.p.bitLength(),this.k=new r(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function w(){_.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function v(){_.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function y(){_.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function b(){_.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function M(t){if("string"==typeof t){var e=r._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function x(t){M.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new r(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}_.prototype._tmp=function(){var t=new r(null);return t.words=new Array(Math.ceil(this.n/13)),t},_.prototype.ireduce=function(t){var e,n=t;do{this.split(n,this.tmp),e=(n=(n=this.imulK(n)).iadd(this.tmp)).bitLength()}while(e>this.n);var i=e<this.n?-1:n.ucmp(this.p);return 0===i?(n.words[0]=0,n.length=1):i>0?n.isub(this.p):n.strip(),n},_.prototype.split=function(t,e){t.iushrn(this.n,0,e)},_.prototype.imulK=function(t){return t.imul(this.k)},i(w,_),w.prototype.split=function(t,e){for(var n=4194303,i=Math.min(t.length,9),r=0;r<i;r++)e.words[r]=t.words[r];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var o=t.words[9];for(e.words[e.length++]=o&n,r=10;r<t.length;r++){var s=0|t.words[r];t.words[r-10]=(s&n)<<4|o>>>22,o=s}o>>>=22,t.words[r-10]=o,0===o&&t.length>10?t.length-=10:t.length-=9},w.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,n=0;n<t.length;n++){var i=0|t.words[n];e+=977*i,t.words[n]=67108863&e,e=64*i+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},i(v,_),i(y,_),i(b,_),b.prototype.imulK=function(t){for(var e=0,n=0;n<t.length;n++){var i=19*(0|t.words[n])+e,r=67108863&i;i>>>=26,t.words[n]=r,e=i}return 0!==e&&(t.words[t.length++]=e),t},r._prime=function(t){if(g[t])return g[t];var e;if("k256"===t)e=new w;else if("p224"===t)e=new v;else if("p192"===t)e=new y;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new b}return g[t]=e,e},M.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},M.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},M.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},M.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},M.prototype.add=function(t,e){this._verify2(t,e);var n=t.add(e);return n.cmp(this.m)>=0&&n.isub(this.m),n._forceRed(this)},M.prototype.iadd=function(t,e){this._verify2(t,e);var n=t.iadd(e);return n.cmp(this.m)>=0&&n.isub(this.m),n},M.prototype.sub=function(t,e){this._verify2(t,e);var n=t.sub(e);return n.cmpn(0)<0&&n.iadd(this.m),n._forceRed(this)},M.prototype.isub=function(t,e){this._verify2(t,e);var n=t.isub(e);return n.cmpn(0)<0&&n.iadd(this.m),n},M.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},M.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},M.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},M.prototype.isqr=function(t){return this.imul(t,t.clone())},M.prototype.sqr=function(t){return this.mul(t,t)},M.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var i=this.m.add(new r(1)).iushrn(2);return this.pow(t,i)}for(var o=this.m.subn(1),s=0;!o.isZero()&&0===o.andln(1);)s++,o.iushrn(1);n(!o.isZero());var a=new r(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),l=this.m.bitLength();for(l=new r(2*l*l).toRed(this);0!==this.pow(l,c).cmp(h);)l.redIAdd(h);for(var u=this.pow(l,o),d=this.pow(t,o.addn(1).iushrn(1)),p=this.pow(t,o),m=s;0!==p.cmp(a);){for(var f=p,g=0;0!==f.cmp(a);g++)f=f.redSqr();n(g<m);var _=this.pow(u,new r(1).iushln(m-g-1));d=d.redMul(_),u=_.redSqr(),p=p.redMul(u),m=g}return d},M.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},M.prototype.pow=function(t,e){if(e.isZero())return new r(1).toRed(this);if(0===e.cmpn(1))return t.clone();var n=new Array(16);n[0]=new r(1).toRed(this),n[1]=t;for(var i=2;i<n.length;i++)n[i]=this.mul(n[i-1],t);var o=n[0],s=0,a=0,h=e.bitLength()%26;for(0===h&&(h=26),i=e.length-1;i>=0;i--){for(var c=e.words[i],l=h-1;l>=0;l--){var u=c>>l&1;o!==n[0]&&(o=this.sqr(o)),0!==u||0!==s?(s<<=1,s|=u,(4==++a||0===i&&0===l)&&(o=this.mul(o,n[s]),a=0,s=0)):a=0}h=26}return o},M.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},M.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},r.mont=function(t){return new x(t)},i(x,M),x.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},x.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},x.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var n=t.imul(e),i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=n.isub(i).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},x.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new r(0)._forceRed(this);var n=t.mul(e),i=n.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),o=n.isub(i).iushrn(this.shift),s=o;return o.cmp(this.m)>=0?s=o.isub(this.m):o.cmpn(0)<0&&(s=o.iadd(this.m)),s._forceRed(this)},x.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(Pt,o);var zt=Pt.exports;function Ut(t){return new Uint8Array(t)}function Bt(t,e=!1){const n=t.toString("hex");return e?Jt(n):n}function Wt(t){return h(t)}function Dt(t,e=!1){return Bt(Wt(t),e)}function $t(t){return Ut(function(t){return Buffer.from(Ht(t),"hex")}(t))}function Zt(t){return Buffer.from(t,"utf8")}function Ft(...t){let e=[];return t.forEach((t=>e=e.concat(Array.from(t)))),new Uint8Array([...e])}function Qt(t,e=8,n="0"){return function(t,e,n="0"){return function(t,e,n,i="0"){const r=e-t.length;let o=t;if(r>0){const e=i.repeat(r);o=n?e+t:t+e}return o}(t,e,!0,n)}(t,function(t,e=8){const n=t%e;return n?(t-n)/e*e+e:t}(t.length,e),n)}function Ht(t){return t.replace(/^0x/,"")}function Jt(t){return t.startsWith("0x")?t:`0x${t}`}function Kt(t){return(t=Qt(t=Ht(t),2))&&(t=Jt(t)),t}function Vt(t){return Wt(new Uint8Array(t))}function Yt(t,e){return function(t,e=!1){return Bt(Zt(t),e)}(t,!e)}function Gt(t,e){const n=Ht(Kt(new zt(t).toString(16)));return e?n:Jt(n)}function Xt(t){return Kt(t)}function te(t){return function(t){const e=t.startsWith("0x");return t=(t=Ht(t)).startsWith("0")?t.substring(1):t,e?Jt(t):t}(Jt(t))}const ee=E;function ne(){return((t,e)=>{for(e=t="";t++<36;e+=51*t&52?(15^t?8^Math.random()*(20^t?16:4):4).toString(16):"-");return e})()}function ie(t,e){let n;const i=function(t,e){let n;const i=jt[t];return i&&(n=`https://${i}.infura.io/v3/${e}`),n}(t,e.infuraId);return e.custom&&e.custom[t]?n=e.custom[t]:i&&(n=i),n}function re(t,e){return function(t,e){return!("string"!=typeof t||!t.match(/^0x[0-9A-Fa-f]*$/)||e&&t.length!==2+2*e)}(t,e)}function oe(t){return void 0!==t.result}function se(t){return void 0!==t.error}function ae(t){return void 0!==t.event}function he(t){t=Ht(t.toLowerCase());const e=Ht(n.exports.keccak_256(Zt(t)));let i="";for(let n=0;n<t.length;n++)parseInt(e[n],16)>7?i+=t[n].toUpperCase():i+=t[n];return Jt(i)}function ce(t){var e;return(e=t)&&e.length&&!re(t[0])&&(t[0]=Yt(t[0])),t}function le(t){if(void 0!==t.type&&"0"!==t.type)return t;if(void 0===t.from||(!(e=t.from)||"0x"!==e.toLowerCase().substring(0,2)||!/^(0x)?[0-9a-f]{40}$/i.test(e)||!/^(0x)?[0-9a-f]{40}$/.test(e)&&!/^(0x)?[0-9A-F]{40}$/.test(e)&&e!==he(e)))throw new Error("Transaction object must include a valid 'from' value.");var e;function n(t){let e=t;return("number"==typeof t||"string"==typeof t&&!function(t){return""===t||"string"==typeof t&&""===t.trim()}(t))&&(re(t)?"string"==typeof t&&(e=Xt(t)):e=Gt(t)),"string"==typeof e&&(e=te(e)),e}const i={from:Xt(t.from),to:void 0===t.to?"":Xt(t.to),gasPrice:void 0===t.gasPrice?"":n(t.gasPrice),gas:void 0===t.gas?void 0===t.gasLimit?"":n(t.gasLimit):n(t.gas),value:void 0===t.value?"":n(t.value),nonce:void 0===t.nonce?"":n(t.nonce),data:void 0===t.data?"":Xt(t.data)||"0x"},r=["gasPrice","gas","value","nonce"];return Object.keys(i).forEach((t=>{!i[t].trim().length&&r.includes(t)&&delete i[t]})),i}function ue(t,e){let n=de(t);return n=Object.assign(Object.assign({},n),e),t=function(t){return i.stringify(t)}(n)}function de(t){return i.parse(t)}class pe{constructor(){this._eventEmitters=[],"undefined"!=typeof window&&void 0!==window.addEventListener&&(window.addEventListener("online",(()=>this.trigger("online"))),window.addEventListener("offline",(()=>this.trigger("offline"))))}on(t,e){this._eventEmitters.push({event:t,callback:e})}trigger(t){let e=[];t&&(e=this._eventEmitters.filter((e=>e.event===t))),e.forEach((t=>{t.callback()}))}}const me=void 0!==global.WebSocket?global.WebSocket:require("ws");class fe{constructor(t){if(this.opts=t,this._queue=[],this._events=[],this._subscriptions=[],this._protocol=t.protocol,this._version=t.version,this._url="",this._netMonitor=null,this._socket=null,this._nextSocket=null,this._subscriptions=t.subscriptions||[],this._netMonitor=t.netMonitor||new pe,!t.url||"string"!=typeof t.url)throw new Error("Missing or invalid WebSocket url");this._url=t.url,this._netMonitor.on("online",(()=>this._socketCreate()))}set readyState(t){}get readyState(){return this._socket?this._socket.readyState:-1}set connecting(t){}get connecting(){return 0===this.readyState}set connected(t){}get connected(){return 1===this.readyState}set closing(t){}get closing(){return 2===this.readyState}set closed(t){}get closed(){return 3===this.readyState}open(){this._socketCreate()}close(){this._socketClose()}send(t,e,n){if(!e||"string"!=typeof e)throw new Error("Missing or invalid topic field");this._socketSend({topic:e,type:"pub",payload:t,silent:!!n})}subscribe(t){this._socketSend({topic:t,type:"sub",payload:"",silent:!0})}on(t,e){this._events.push({event:t,callback:e})}_socketCreate(){if(this._nextSocket)return;const t=function(t,e,n){var i,r;const o=(t.startsWith("https")?t.replace("https","wss"):t.startsWith("http")?t.replace("http","ws"):t).split("?"),s=ut()?{protocol:e,version:n,env:"browser",host:(null===(i=vt())||void 0===i?void 0:i.host)||""}:{protocol:e,version:n,env:(null===(r=ot())||void 0===r?void 0:r.name)||""},a=ue(function(t){const e=-1!==t.indexOf("?")?t.indexOf("?"):void 0;return void 0!==e?t.substr(e):""}(o[1]||""),s);return o[0]+"?"+a}(this._url,this._protocol,this._version);if(this._nextSocket=new me(t),!this._nextSocket)throw new Error("Failed to create socket");this._nextSocket.onmessage=t=>this._socketReceive(t),this._nextSocket.onopen=()=>this._socketOpen(),this._nextSocket.onerror=t=>this._socketError(t),this._nextSocket.onclose=()=>{setTimeout((()=>{this._nextSocket=null,this._socketCreate()}),1e3)}}_socketOpen(){this._socketClose(),this._socket=this._nextSocket,this._nextSocket=null,this._queueSubscriptions(),this._pushQueue()}_socketClose(){this._socket&&(this._socket.onclose=()=>{},this._socket.close())}_socketSend(t){const e=JSON.stringify(t);this._socket&&1===this._socket.readyState?this._socket.send(e):(this._setToQueue(t),this._socketCreate())}async _socketReceive(t){let e;try{e=JSON.parse(t.data)}catch(n){return}if(this._socketSend({topic:e.topic,type:"ack",payload:"",silent:!0}),this._socket&&1===this._socket.readyState){const t=this._events.filter((t=>"message"===t.event));t&&t.length&&t.forEach((t=>t.callback(e)))}}_socketError(t){const e=this._events.filter((t=>"error"===t.event));e&&e.length&&e.forEach((e=>e.callback(t)))}_queueSubscriptions(){this._subscriptions.forEach((t=>this._queue.push({topic:t,type:"sub",payload:"",silent:!0}))),this._subscriptions=this.opts.subscriptions||[]}_setToQueue(t){this._queue.push(t)}_pushQueue(){this._queue.forEach((t=>this._socketSend(t))),this._queue=[]}}class ge{constructor(){this._eventEmitters=[]}subscribe(t){this._eventEmitters.push(t)}unsubscribe(t){this._eventEmitters=this._eventEmitters.filter((e=>e.event!==t))}trigger(t){let e,n=[];e=void 0!==t.method?t.method:oe(t)||se(t)?`response:${t.id}`:ae(t)?t.event:"",e&&(n=this._eventEmitters.filter((t=>t.event===e))),n&&n.length||function(t){return Lt.includes(t)||t.startsWith("wc_")}(e)||ae(e)||(n=this._eventEmitters.filter((t=>"call_request"===t.event))),n.forEach((e=>{if(se(t)){const n=new Error(t.error.message);e.callback(n,null)}else e.callback(null,t)}))}}class _e{constructor(t="walletconnect"){this.storageId=t}getSession(){let t=null;const e=Ct(this.storageId);return e&&void 0!==e.bridge&&(t=e),t}setSession(t){return It(this.storageId,t),t}removeSession(){Rt(this.storageId)}}const we="abcdefghijklmnopqrstuvwxyz0123456789".split("").map((t=>`https://${t}.bridge.walletconnect.org`));function ve(){return we[Math.floor(Math.random()*we.length)]}async function ye(t,e="AES-CBC"){return g.getSubtleCrypto().importKey("raw",t,function(t){return"AES-CBC"===t?{length:256,name:"AES-CBC"}:{hash:{name:"SHA-256"},name:"HMAC"}}(e),!0,function(t){return"AES-CBC"===t?["encrypt","decrypt"]:["sign","verify"]}(e))}function be(t,e,n){return async function(t,e,n){const i=g.getSubtleCrypto(),r=await ye(e,"AES-CBC"),o=await i.encrypt({iv:t,name:"AES-CBC"},r,n);return new Uint8Array(o)}(t,e,n)}function Me(t,e,n){return async function(t,e,n){const i=g.getSubtleCrypto(),r=await ye(e,"AES-CBC"),o=await i.decrypt({iv:t,name:"AES-CBC"},r,n);return new Uint8Array(o)}(t,e,n)}async function xe(t,e){return await async function(t,e){const n=g.getSubtleCrypto(),i=await ye(t,"HMAC"),r=await n.sign({length:256,name:"HMAC"},i,e);return new Uint8Array(r)}(t,e)}async function ke(t){const e=function(t){return g.getBrowerCrypto().getRandomValues(new Uint8Array(t))}((t||256)/8);return Ut(Wt(e)).buffer}async function Se(t,e){const n=$t(t.data),i=$t(t.iv),r=Dt($t(t.hmac),!1),o=Ft(n,i),s=Dt(await xe(e,o),!1);return Ht(r)===Ht(s)}var Ee=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",generateKey:ke,verifyHmac:Se,encrypt:async function(t,e,n){const i=Ut(Vt(e)),r=Ut(Vt(n||await ke(128))),o=Dt(r,!1),s=Ut(Zt(JSON.stringify(t))),a=await be(r,i,s),h=Dt(a,!1),c=Ft(a,r);return{data:h,hmac:Dt(await xe(i,c),!1),iv:o}},decrypt:async function(t,e){const n=Ut(Vt(e));if(!n)throw new Error("Missing key: required for decryption");if(!(await Se(t,n)))return null;const i=$t(t.data),r=$t(t.iv),o=Wt(await Me(r,n,i)).toString("utf8");let s;try{s=JSON.parse(o)}catch(a){return null}return s}});class Ie extends class{constructor(t){if(this.protocol="wc",this.version=1,this._bridge="",this._key=null,this._clientId="",this._clientMeta=null,this._peerId="",this._peerMeta=null,this._handshakeId=0,this._handshakeTopic="",this._connected=!1,this._accounts=[],this._chainId=0,this._networkId=0,this._rpcUrl="",this._eventManager=new ge,this._clientMeta=kt()||t.connectorOpts.clientMeta||null,this._cryptoLib=t.cryptoLib,this._sessionStorage=t.sessionStorage||new _e(t.connectorOpts.storageId),this._qrcodeModal=t.connectorOpts.qrcodeModal,this._qrcodeModalOptions=t.connectorOpts.qrcodeModalOptions,this._signingMethods=[...At,...t.connectorOpts.signingMethods||[]],!t.connectorOpts.bridge&&!t.connectorOpts.uri&&!t.connectorOpts.session)throw new Error("Missing one of the required parameters: bridge / uri / session");var e;t.connectorOpts.bridge&&(this.bridge=function(t){return"walletconnect.org"===function(t){return function(t){let e=t.indexOf("//")>-1?t.split("/")[2]:t.split("/")[0];return e=e.split(":")[0],e=e.split("?")[0],e}(t).split(".").slice(-2).join(".")}(t)}(e=t.connectorOpts.bridge)?ve():e),t.connectorOpts.uri&&(this.uri=t.connectorOpts.uri);const n=t.connectorOpts.session||this._getStorageSession();n&&(this.session=n),this.handshakeId&&this._subscribeToSessionResponse(this.handshakeId,"Session request rejected"),this._transport=t.transport||new fe({protocol:this.protocol,version:this.version,url:this.bridge,subscriptions:[this.clientId]}),this._subscribeToInternalEvents(),this._initTransport(),t.connectorOpts.uri&&this._subscribeToSessionRequest(),t.pushServerOpts&&this._registerPushServer(t.pushServerOpts)}set bridge(t){t&&(this._bridge=t)}get bridge(){return this._bridge}set key(t){if(!t)return;const e=$t(t).buffer;this._key=e}get key(){if(this._key){return t=this._key,e=!0,Dt(new Uint8Array(t),!e)}var t,e;return""}set clientId(t){t&&(this._clientId=t)}get clientId(){let t=this._clientId;return t||(t=this._clientId=ne()),this._clientId}set peerId(t){t&&(this._peerId=t)}get peerId(){return this._peerId}set clientMeta(t){}get clientMeta(){let t=this._clientMeta;return t||(t=this._clientMeta=kt()),t}set peerMeta(t){this._peerMeta=t}get peerMeta(){return this._peerMeta}set handshakeTopic(t){t&&(this._handshakeTopic=t)}get handshakeTopic(){return this._handshakeTopic}set handshakeId(t){t&&(this._handshakeId=t)}get handshakeId(){return this._handshakeId}get uri(){return this._formatUri()}set uri(t){if(!t)return;const{handshakeTopic:e,bridge:n,key:i}=this._parseUri(t);this.handshakeTopic=e,this.bridge=n,this.key=i}set chainId(t){this._chainId=t}get chainId(){return this._chainId}set networkId(t){this._networkId=t}get networkId(){return this._networkId}set accounts(t){this._accounts=t}get accounts(){return this._accounts}set rpcUrl(t){this._rpcUrl=t}get rpcUrl(){return this._rpcUrl}set connected(t){}get connected(){return this._connected}set pending(t){}get pending(){return!!this._handshakeTopic}get session(){return{connected:this.connected,accounts:this.accounts,chainId:this.chainId,bridge:this.bridge,key:this.key,clientId:this.clientId,clientMeta:this.clientMeta,peerId:this.peerId,peerMeta:this.peerMeta,handshakeId:this.handshakeId,handshakeTopic:this.handshakeTopic}}set session(t){t&&(this._connected=t.connected,this.accounts=t.accounts,this.chainId=t.chainId,this.bridge=t.bridge,this.key=t.key,this.clientId=t.clientId,this.clientMeta=t.clientMeta,this.peerId=t.peerId,this.peerMeta=t.peerMeta,this.handshakeId=t.handshakeId,this.handshakeTopic=t.handshakeTopic)}on(t,e){const n={event:t,callback:e};this._eventManager.subscribe(n)}off(t){this._eventManager.unsubscribe(t)}async createInstantRequest(t){this._key=await this._generateKey();const e=this._formatRequest({method:"wc_instantRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,request:this._formatRequest(t)}]});this.handshakeId=e.id,this.handshakeTopic=ne(),this._eventManager.trigger({event:"display_uri",params:[this.uri]}),this.on("modal_closed",(()=>{throw new Error("User close QRCode Modal")}));const n=()=>{this.killSession()};try{const t=await this._sendCallRequest(e);return t&&n(),t}catch(i){throw n(),i}}async connect(t){if(!this._qrcodeModal)throw new Error("QRCode Modal not provided");return this.connected?{chainId:this.chainId,accounts:this.accounts}:(await this.createSession(t),new Promise((async(t,e)=>{this.on("modal_closed",(()=>e(new Error("User close QRCode Modal")))),this.on("connect",((n,i)=>{if(n)return e(n);t(i.params[0])}))})))}async createSession(t){if(this._connected)throw new Error("Session currently connected");if(this.pending)return;this._key=await this._generateKey();const e=this._formatRequest({method:"wc_sessionRequest",params:[{peerId:this.clientId,peerMeta:this.clientMeta,chainId:t&&t.chainId?t.chainId:null}]});this.handshakeId=e.id,this.handshakeTopic=ne(),this._sendSessionRequest(e,"Session update rejected",{topic:this.handshakeTopic}),this._eventManager.trigger({event:"display_uri",params:[this.uri]})}approveSession(t){if(this._connected)throw new Error("Session currently connected");this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const e={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl,peerId:this.clientId,peerMeta:this.clientMeta},n={id:this.handshakeId,jsonrpc:"2.0",result:e};this._sendResponse(n),this._connected=!0,this._setStorageSession(),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})}rejectSession(t){if(this._connected)throw new Error("Session currently connected");const e=t&&t.message?t.message:"Session Rejected",n=this._formatResponse({id:this.handshakeId,error:{message:e}});this._sendResponse(n),this._connected=!1,this._eventManager.trigger({event:"disconnect",params:[{message:e}]}),this._removeStorageSession()}updateSession(t){if(!this._connected)throw new Error("Session currently disconnected");this.chainId=t.chainId,this.accounts=t.accounts,this.networkId=t.networkId||0,this.rpcUrl=t.rpcUrl||"";const e={approved:!0,chainId:this.chainId,networkId:this.networkId,accounts:this.accounts,rpcUrl:this.rpcUrl},n=this._formatRequest({method:"wc_sessionUpdate",params:[e]});this._sendSessionRequest(n,"Session update rejected"),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]}),this._manageStorageSession()}async killSession(t){const e=t?t.message:"Session Disconnected",n=this._formatRequest({method:"wc_sessionUpdate",params:[{approved:!1,chainId:null,networkId:null,accounts:null}]});await this._sendRequest(n),this._handleSessionDisconnect(e)}async sendTransaction(t){if(!this._connected)throw new Error("Session currently disconnected");const e=le(t),n=this._formatRequest({method:"eth_sendTransaction",params:[e]});return await this._sendCallRequest(n)}async signTransaction(t){if(!this._connected)throw new Error("Session currently disconnected");const e=le(t),n=this._formatRequest({method:"eth_signTransaction",params:[e]});return await this._sendCallRequest(n)}async signMessage(t){if(!this._connected)throw new Error("Session currently disconnected");const e=this._formatRequest({method:"eth_sign",params:t});return await this._sendCallRequest(e)}async signPersonalMessage(t){if(!this._connected)throw new Error("Session currently disconnected");t=ce(t);const e=this._formatRequest({method:"personal_sign",params:t});return await this._sendCallRequest(e)}async signTypedData(t){if(!this._connected)throw new Error("Session currently disconnected");const e=this._formatRequest({method:"eth_signTypedData",params:t});return await this._sendCallRequest(e)}async updateChain(t){if(!this._connected)throw new Error("Session currently disconnected");const e=this._formatRequest({method:"wallet_updateChain",params:[t]});return await this._sendCallRequest(e)}unsafeSend(t,e){return this._sendRequest(t,e),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:e}]}),new Promise(((e,n)=>{this._subscribeToResponse(t.id,((t,i)=>{if(t)n(t);else{if(!i)throw new Error("Missing JSON RPC response");e(i)}}))}))}async sendCustomRequest(t,e){if(!this._connected)throw new Error("Session currently disconnected");switch(t.method){case"eth_accounts":return this.accounts;case"eth_chainId":return Gt(this.chainId);case"eth_sendTransaction":case"eth_signTransaction":t.params&&(t.params[0]=le(t.params[0]));break;case"personal_sign":t.params&&(t.params=ce(t.params))}const n=this._formatRequest(t);return await this._sendCallRequest(n,e)}approveRequest(t){if(!oe(t))throw new Error('JSON-RPC success response must include "result" field');{const e=this._formatResponse(t);this._sendResponse(e)}}rejectRequest(t){if(!se(t))throw new Error('JSON-RPC error response must include "error" field');{const e=this._formatResponse(t);this._sendResponse(e)}}transportClose(){this._transport.close()}async _sendRequest(t,e){const n=this._formatRequest(t),i=await this._encrypt(n),r=void 0!==(null==e?void 0:e.topic)?e.topic:this.peerId,o=JSON.stringify(i),s=void 0!==(null==e?void 0:e.forcePushNotification)?!e.forcePushNotification:function(t){return!!t.method.startsWith("wc_")||!At.includes(t.method)}(n);this._transport.send(o,r,s)}async _sendResponse(t){const e=await this._encrypt(t),n=this.peerId,i=JSON.stringify(e);this._transport.send(i,n,!0)}async _sendSessionRequest(t,e,n){this._sendRequest(t,n),this._subscribeToSessionResponse(t.id,e)}_sendCallRequest(t,e){return this._sendRequest(t,e),this._eventManager.trigger({event:"call_request_sent",params:[{request:t,options:e}]}),this._subscribeToCallResponse(t.id)}_formatRequest(t){if(void 0===t.method)throw new Error('JSON RPC request must have valid "method" value');return{id:void 0===t.id?ee():t.id,jsonrpc:"2.0",method:t.method,params:void 0===t.params?[]:t.params}}_formatResponse(t){if(void 0===t.id)throw new Error('JSON RPC request must have valid "id" value');const e={id:t.id,jsonrpc:"2.0"};if(se(t)){const n=function(t){const e=t.message||"Failed or Rejected Request";let n=-32e3;if(t&&!t.code)switch(e){case"Parse error":n=-32700;break;case"Invalid request":n=-32600;break;case"Method not found":n=-32601;break;case"Invalid params":n=-32602;break;case"Internal error":n=-32603;break;default:n=-32e3}return{code:n,message:e}}(t.error);return Object.assign(Object.assign(Object.assign({},e),t),{error:n})}if(oe(t)){return Object.assign(Object.assign({},e),t)}throw new Error("JSON RPC response format is invalid")}_handleSessionDisconnect(t){const e=t||"Session Disconnected";this._connected||(this._qrcodeModal&&this._qrcodeModal.close(),Rt("WALLETCONNECT_DEEPLINK_CHOICE")),this._connected&&(this._connected=!1),this._handshakeId&&(this._handshakeId=0),this._handshakeTopic&&(this._handshakeTopic=""),this._peerId&&(this._peerId=""),this._eventManager.trigger({event:"disconnect",params:[{message:e}]}),this._removeStorageSession(),this.transportClose()}_handleSessionResponse(t,e){e&&e.approved?(this._connected?(e.chainId&&(this.chainId=e.chainId),e.accounts&&(this.accounts=e.accounts),this._eventManager.trigger({event:"session_update",params:[{chainId:this.chainId,accounts:this.accounts}]})):(this._connected=!0,e.chainId&&(this.chainId=e.chainId),e.accounts&&(this.accounts=e.accounts),e.peerId&&!this.peerId&&(this.peerId=e.peerId),e.peerMeta&&!this.peerMeta&&(this.peerMeta=e.peerMeta),this._eventManager.trigger({event:"connect",params:[{peerId:this.peerId,peerMeta:this.peerMeta,chainId:this.chainId,accounts:this.accounts}]})),this._manageStorageSession()):this._handleSessionDisconnect(t)}async _handleIncomingMessages(t){if(![this.clientId,this.handshakeTopic].includes(t.topic))return;let e;try{e=JSON.parse(t.payload)}catch(i){return}const n=await this._decrypt(e);n&&this._eventManager.trigger(n)}_subscribeToSessionRequest(){this._transport.subscribe(this.handshakeTopic)}_subscribeToResponse(t,e){this.on(`response:${t}`,e)}_subscribeToSessionResponse(t,e){this._subscribeToResponse(t,((t,n)=>{t?this._handleSessionResponse(t.message):n.result?this._handleSessionResponse(e,n.result):n.error&&n.error.message?this._handleSessionResponse(n.error.message):this._handleSessionResponse(e)}))}_subscribeToCallResponse(t){return new Promise(((e,n)=>{this._subscribeToResponse(t,((t,i)=>{t?n(t):i.result?e(i.result):i.error&&i.error.message?n(new Error(i.error.message)):n(new Error("JSON RPC response format is invalid"))}))}))}_subscribeToInternalEvents(){this.on("display_uri",(()=>{this._qrcodeModal&&this._qrcodeModal.open(this.uri,(()=>{this._eventManager.trigger({event:"modal_closed",params:[]})}),this._qrcodeModalOptions)})),this.on("connect",(()=>{this._qrcodeModal&&this._qrcodeModal.close()})),this.on("call_request_sent",((t,e)=>{const{request:n}=e.params[0];if(ct()&&this._signingMethods.includes(n.method)){const t=Ct("WALLETCONNECT_DEEPLINK_CHOICE");t&&(window.location.href=t.href)}})),this.on("wc_sessionRequest",((t,e)=>{t&&this._eventManager.trigger({event:"error",params:[{code:"SESSION_REQUEST_ERROR",message:t.toString()}]}),this.handshakeId=e.id,this.peerId=e.params[0].peerId,this.peerMeta=e.params[0].peerMeta;const n=Object.assign(Object.assign({},e),{method:"session_request"});this._eventManager.trigger(n)})),this.on("wc_sessionUpdate",((t,e)=>{t&&this._handleSessionResponse(t.message),this._handleSessionResponse("Session disconnected",e.params[0])}))}_initTransport(){this._transport.on("message",(t=>this._handleIncomingMessages(t))),this._transport.on("open",(()=>this._eventManager.trigger({event:"transport_open",params:[]}))),this._transport.on("close",(()=>this._eventManager.trigger({event:"transport_close",params:[]}))),this._transport.on("error",(()=>this._eventManager.trigger({event:"transport_error",params:["Websocket connection failed"]}))),this._transport.open()}_formatUri(){return`${this.protocol}:${this.handshakeTopic}@${this.version}?bridge=${encodeURIComponent(this.bridge)}&key=${this.key}`}_parseUri(t){const e=function(t){const e=t.indexOf(":"),n=-1!==t.indexOf("?")?t.indexOf("?"):void 0,i=t.substring(0,e),r=function(t){const e=t.split("@");return{handshakeTopic:e[0],version:parseInt(e[1],10)}}(t.substring(e+1,n)),o=function(t){const e=de(t);return{key:e.key||"",bridge:e.bridge||""}}(void 0!==n?t.substr(n):"");return Object.assign(Object.assign({protocol:i},r),o)}(t);if(e.protocol===this.protocol){if(!e.handshakeTopic)throw Error("Invalid or missing handshakeTopic parameter value");const t=e.handshakeTopic;if(!e.bridge)throw Error("Invalid or missing bridge url parameter value");const n=decodeURIComponent(e.bridge);if(!e.key)throw Error("Invalid or missing key parameter value");return{handshakeTopic:t,bridge:n,key:e.key}}throw new Error("URI format is invalid")}async _generateKey(){if(this._cryptoLib){return await this._cryptoLib.generateKey()}return null}async _encrypt(t){const e=this._key;if(this._cryptoLib&&e){return await this._cryptoLib.encrypt(t,e)}return null}async _decrypt(t){const e=this._key;if(this._cryptoLib&&e){return await this._cryptoLib.decrypt(t,e)}return null}_getStorageSession(){let t=null;return this._sessionStorage&&(t=this._sessionStorage.getSession()),t}_setStorageSession(){this._sessionStorage&&this._sessionStorage.setSession(this.session)}_removeStorageSession(){this._sessionStorage&&this._sessionStorage.removeSession()}_manageStorageSession(){this._connected?this._setStorageSession():this._removeStorageSession()}_registerPushServer(t){if(!t.url||"string"!=typeof t.url)throw Error("Invalid or missing pushServerOpts.url parameter value");if(!t.type||"string"!=typeof t.type)throw Error("Invalid or missing pushServerOpts.type parameter value");if(!t.token||"string"!=typeof t.token)throw Error("Invalid or missing pushServerOpts.token parameter value");const e={bridge:this.bridge,topic:this.clientId,type:t.type,token:t.token,peerName:"",language:t.language||""};this.on("connect",(async(n,i)=>{if(n)throw n;if(t.peerMeta){const t=i.params[0].peerMeta.name;e.peerName=t}try{const n=await fetch(`${t.url}/new`,{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(e)});if(!(await n.json()).success)throw Error("Failed to register in Push Server")}catch(r){throw Error("Failed to register in Push Server")}}))}}{constructor(t,e){super({cryptoLib:Ee,connectorOpts:t,pushServerOpts:e})}}function Ce(t){return t&&"object"==typeof t&&"default"in t?t.default:t}var Re=s(Nt),Oe=Ce(l),qe=Ce(u),Te=d;"undefined"==typeof Symbol||(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"==typeof Symbol||(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function Ne(t){return Te.createElement("div",{className:"walletconnect-modal__header"},Te.createElement("img",{src:"data:image/svg+xml,%3Csvg height='185' viewBox='0 0 300 185' width='300' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='m61.4385429 36.2562612c48.9112241-47.8881663 128.2119871-47.8881663 177.1232091 0l5.886545 5.7634174c2.445561 2.3944081 2.445561 6.2765112 0 8.6709204l-20.136695 19.715503c-1.222781 1.1972051-3.2053 1.1972051-4.428081 0l-8.100584-7.9311479c-34.121692-33.4079817-89.443886-33.4079817-123.5655788 0l-8.6750562 8.4936051c-1.2227816 1.1972041-3.205301 1.1972041-4.4280806 0l-20.1366949-19.7155031c-2.4455612-2.3944092-2.4455612-6.2765122 0-8.6709204zm218.7677961 40.7737449 17.921697 17.546897c2.445549 2.3943969 2.445563 6.2764769.000031 8.6708899l-80.810171 79.121134c-2.445544 2.394426-6.410582 2.394453-8.85616.000062-.00001-.00001-.000022-.000022-.000032-.000032l-57.354143-56.154572c-.61139-.598602-1.60265-.598602-2.21404 0-.000004.000004-.000007.000008-.000011.000011l-57.3529212 56.154531c-2.4455368 2.394432-6.4105755 2.394472-8.8561612.000087-.0000143-.000014-.0000296-.000028-.0000449-.000044l-80.81241943-79.122185c-2.44556021-2.394408-2.44556021-6.2765115 0-8.6709197l17.92172963-17.5468673c2.4455602-2.3944082 6.4105989-2.3944082 8.8561602 0l57.3549775 56.155357c.6113908.598602 1.602649.598602 2.2140398 0 .0000092-.000009.0000174-.000017.0000265-.000024l57.3521031-56.155333c2.445505-2.3944633 6.410544-2.3945531 8.856161-.0002.000034.0000336.000068.0000673.000101.000101l57.354902 56.155432c.61139.598601 1.60265.598601 2.21404 0l57.353975-56.1543249c2.445561-2.3944092 6.410599-2.3944092 8.85616 0z' fill='%233b99fc'/%3E%3C/svg%3E",className:"walletconnect-modal__headerLogo"}),Te.createElement("p",null,"WalletConnect"),Te.createElement("div",{className:"walletconnect-modal__close__wrapper",onClick:t.onClose},Te.createElement("div",{id:"walletconnect-qrcode-close",className:"walletconnect-modal__close__icon"},Te.createElement("div",{className:"walletconnect-modal__close__line1"}),Te.createElement("div",{className:"walletconnect-modal__close__line2"}))))}function Le(t){return Te.createElement("a",{className:"walletconnect-connect__button",href:t.href,id:"walletconnect-connect-button-"+t.name,onClick:t.onClick,rel:"noopener noreferrer",style:{backgroundColor:t.color},target:"_blank"},t.name)}function Ae(t){var e=t.color,n=t.href,i=t.name,r=t.logo,o=t.onClick;return Te.createElement("a",{className:"walletconnect-modal__base__row",href:n,onClick:o,rel:"noopener noreferrer",target:"_blank"},Te.createElement("h3",{className:"walletconnect-modal__base__row__h3"},i),Te.createElement("div",{className:"walletconnect-modal__base__row__right"},Te.createElement("div",{className:"walletconnect-modal__base__row__right__app-icon",style:{background:"url('"+r+"') "+e,backgroundSize:"100%"}}),Te.createElement("img",{src:"data:image/svg+xml,%3Csvg fill='none' height='18' viewBox='0 0 8 18' width='8' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath clip-rule='evenodd' d='m.586301.213898c-.435947.33907-.5144813.967342-.175411 1.403292l4.87831 6.27212c.28087.36111.28087.86677 0 1.22788l-4.878311 6.27211c-.33907.436-.260536 1.0642.175412 1.4033.435949.3391 1.064219.2605 1.403289-.1754l4.87832-6.2721c.84259-1.08336.84259-2.60034 0-3.68367l-4.87832-6.27212c-.33907-.4359474-.96734-.514482-1.403289-.175412z' fill='%233c4252' fill-rule='evenodd'/%3E%3C/svg%3E",className:"walletconnect-modal__base__row__right__caret"})))}function je(t){var e=t.color,n=t.href,i=t.name,r=t.logo,o=t.onClick,s=window.innerWidth<768?(i.length>8?2.5:2.7)+"vw":"inherit";return Te.createElement("a",{className:"walletconnect-connect__button__icon_anchor",href:n,onClick:o,rel:"noopener noreferrer",target:"_blank"},Te.createElement("div",{className:"walletconnect-connect__button__icon",style:{background:"url('"+r+"') "+e,backgroundSize:"100%"}}),Te.createElement("div",{style:{fontSize:s},className:"walletconnect-connect__button__text"},i))}function Pe(t){var e=Re.isAndroid(),n=Te.useState(""),i=n[0],r=n[1],o=Te.useState(""),s=o[0],a=o[1],h=Te.useState(1),c=h[0],l=h[1],u=s?t.links.filter((function(t){return t.name.toLowerCase().includes(s.toLowerCase())})):t.links,d=t.errorMessage,p=s||u.length>5,m=Math.ceil(u.length/12),f=[12*(c-1)+1,12*c],g=u.length?u.filter((function(t,e){return e+1>=f[0]&&e+1<=f[1]})):[],_=!(e||!(m>1)),w=void 0;return Te.createElement("div",null,Te.createElement("p",{id:"walletconnect-qrcode-text",className:"walletconnect-qrcode__text"},e?t.text.connect_mobile_wallet:t.text.choose_preferred_wallet),!e&&Te.createElement("input",{className:"walletconnect-search__input",placeholder:"Search",value:i,onChange:function(t){r(t.target.value),clearTimeout(w),t.target.value?w=setTimeout((function(){a(t.target.value),l(1)}),1e3):(r(""),a(""),l(1))}}),Te.createElement("div",{className:"walletconnect-connect__buttons__wrapper"+(e?"__android":p&&u.length?"__wrap":"")},e?Te.createElement(Le,{name:t.text.connect,color:"rgb(64, 153, 255)",href:t.uri,onClick:Te.useCallback((function(){Re.saveMobileLinkInfo({name:"Unknown",href:t.uri})}),[])}):g.length?g.map((function(e){var n=e.color,i=e.name,r=e.shortName,o=e.logo,s=Re.formatIOSMobile(t.uri,e),a=Te.useCallback((function(){Re.saveMobileLinkInfo({name:i,href:s})}),[g]);return p?Te.createElement(je,{color:n,href:s,name:r||i,logo:o,onClick:a}):Te.createElement(Ae,{color:n,href:s,name:i,logo:o,onClick:a})})):Te.createElement(Te.Fragment,null,Te.createElement("p",null,d.length?t.errorMessage:t.links.length&&!u.length?t.text.no_wallets_found:t.text.loading))),_&&Te.createElement("div",{className:"walletconnect-modal__footer"},Array(m).fill(0).map((function(t,e){var n=e+1,i=c===n;return Te.createElement("a",{style:{margin:"auto 10px",fontWeight:i?"bold":"normal"},onClick:function(){return l(n)}},n)}))))}function ze(t){var e=!!t.message.trim();return Te.createElement("div",{className:"walletconnect-qrcode__notification"+(e?" notification__show":"")},t.message)}function Ue(t){var e=Te.useState(""),n=e[0],i=e[1],r=Te.useState(""),o=r[0],s=r[1];Te.useEffect((function(){try{return Promise.resolve(function(t){try{var e="";return Promise.resolve(Oe.toString(t,{margin:0,type:"svg"})).then((function(t){return"string"==typeof t&&(e=t.replace("<svg",'<svg class="walletconnect-qrcode__image"')),e}))}catch(n){return Promise.reject(n)}}(t.uri)).then((function(t){s(t)}))}catch(e){Promise.reject(e)}}),[]);return Te.createElement("div",null,Te.createElement("p",{id:"walletconnect-qrcode-text",className:"walletconnect-qrcode__text"},t.text.scan_qrcode_with_wallet),Te.createElement("div",{dangerouslySetInnerHTML:{__html:o}}),Te.createElement("div",{className:"walletconnect-modal__footer"},Te.createElement("a",{onClick:function(){qe(t.uri)?(i(t.text.copied_to_clipboard),setInterval((function(){return i("")}),1200)):(i("Error"),setInterval((function(){return i("")}),1200))}},t.text.copy_to_clipboard)),Te.createElement(ze,{message:n}))}function Be(t){var e=Re.isAndroid(),n=Re.isMobile(),i=n?t.qrcodeModalOptions&&t.qrcodeModalOptions.mobileLinks?t.qrcodeModalOptions.mobileLinks:void 0:t.qrcodeModalOptions&&t.qrcodeModalOptions.desktopLinks?t.qrcodeModalOptions.desktopLinks:void 0,r=Te.useState(!1),o=r[0],s=r[1],a=Te.useState(!1),h=a[0],c=a[1],l=Te.useState(!n),u=l[0],d=l[1],p={mobile:n,text:t.text,uri:t.uri,qrcodeModalOptions:t.qrcodeModalOptions},m=Te.useState(""),f=m[0],g=m[1],_=Te.useState(!1),w=_[0],v=_[1],y=Te.useState([]),b=y[0],M=y[1],x=Te.useState(""),k=x[0],S=x[1],E=function(){h||o||i&&!i.length||b.length>0||Te.useEffect((function(){!function(){try{if(e)return Promise.resolve();s(!0);var r=function(t,e){try{var n=t()}catch(i){return e(i)}return n&&n.then?n.then(void 0,e):n}((function(){var e=t.qrcodeModalOptions&&t.qrcodeModalOptions.registryUrl?t.qrcodeModalOptions.registryUrl:Re.getWalletRegistryUrl();return Promise.resolve(fetch(e)).then((function(e){return Promise.resolve(e.json()).then((function(e){var r=e.listings,o=n?"mobile":"desktop",a=Re.getMobileLinkRegistry(Re.formatMobileRegistry(r,o),i);s(!1),c(!0),S(a.length?"":t.text.no_supported_wallets),M(a);var h=1===a.length;h&&(g(Re.formatIOSMobile(t.uri,a[0])),d(!0)),v(h)}))}))}),(function(e){s(!1),c(!0),S(t.text.something_went_wrong),console.error(e)}));Promise.resolve(r&&r.then?r.then((function(){})):void 0)}catch(o){return Promise.reject(o)}}()}))};E();var I=n?u:!u;return Te.createElement("div",{id:"walletconnect-qrcode-modal",className:"walletconnect-qrcode__base animated fadeIn"},Te.createElement("div",{className:"walletconnect-modal__base"},Te.createElement(Ne,{onClose:t.onClose}),w&&u?Te.createElement("div",{className:"walletconnect-modal__single_wallet"},Te.createElement("a",{onClick:function(){return Re.saveMobileLinkInfo({name:b[0].name,href:f})},href:f,rel:"noopener noreferrer",target:"_blank"},t.text.connect_with+" "+(w?b[0].name:"")+" ›")):e||o||!o&&b.length?Te.createElement("div",{className:"walletconnect-modal__mobile__toggle"+(I?" right__selected":"")},Te.createElement("div",{className:"walletconnect-modal__mobile__toggle_selector"}),n?Te.createElement(Te.Fragment,null,Te.createElement("a",{onClick:function(){return d(!1),E()}},t.text.mobile),Te.createElement("a",{onClick:function(){return d(!0)}},t.text.qrcode)):Te.createElement(Te.Fragment,null,Te.createElement("a",{onClick:function(){return d(!0)}},t.text.qrcode),Te.createElement("a",{onClick:function(){return d(!1),E()}},t.text.desktop))):null,Te.createElement("div",null,u||!e&&!o&&!b.length?Te.createElement(Ue,Object.assign({},p)):Te.createElement(Pe,Object.assign({},p,{links:b,errorMessage:k})))))}var We={de:{choose_preferred_wallet:"Wähle bevorzugte Wallet",connect_mobile_wallet:"Verbinde mit Mobile Wallet",scan_qrcode_with_wallet:"Scanne den QR-code mit einer WalletConnect kompatiblen Wallet",connect:"Verbinden",qrcode:"QR-Code",mobile:"Mobile",desktop:"Desktop",copy_to_clipboard:"In die Zwischenablage kopieren",copied_to_clipboard:"In die Zwischenablage kopiert!",connect_with:"Verbinden mit Hilfe von",loading:"Laden...",something_went_wrong:"Etwas ist schief gelaufen",no_supported_wallets:"Es gibt noch keine unterstützten Wallet",no_wallets_found:"keine Wallet gefunden"},en:{choose_preferred_wallet:"Choose your preferred wallet",connect_mobile_wallet:"Connect to Mobile Wallet",scan_qrcode_with_wallet:"Scan QR code with a WalletConnect-compatible wallet",connect:"Connect",qrcode:"QR Code",mobile:"Mobile",desktop:"Desktop",copy_to_clipboard:"Copy to clipboard",copied_to_clipboard:"Copied to clipboard!",connect_with:"Connect with",loading:"Loading...",something_went_wrong:"Something went wrong",no_supported_wallets:"There are no supported wallets yet",no_wallets_found:"No wallets found"},es:{choose_preferred_wallet:"Elige tu billetera preferida",connect_mobile_wallet:"Conectar a billetera móvil",scan_qrcode_with_wallet:"Escanea el código QR con una billetera compatible con WalletConnect",connect:"Conectar",qrcode:"Código QR",mobile:"Móvil",desktop:"Desktop",copy_to_clipboard:"Copiar",copied_to_clipboard:"Copiado!",connect_with:"Conectar mediante",loading:"Cargando...",something_went_wrong:"Algo salió mal",no_supported_wallets:"Todavía no hay billeteras compatibles",no_wallets_found:"No se encontraron billeteras"},fr:{choose_preferred_wallet:"Choisissez votre portefeuille préféré",connect_mobile_wallet:"Se connecter au portefeuille mobile",scan_qrcode_with_wallet:"Scannez le QR code avec un portefeuille compatible WalletConnect",connect:"Se connecter",qrcode:"QR Code",mobile:"Mobile",desktop:"Desktop",copy_to_clipboard:"Copier",copied_to_clipboard:"Copié!",connect_with:"Connectez-vous à l'aide de",loading:"Chargement...",something_went_wrong:"Quelque chose a mal tourné",no_supported_wallets:"Il n'y a pas encore de portefeuilles pris en charge",no_wallets_found:"Aucun portefeuille trouvé"},ko:{choose_preferred_wallet:"원하는 지갑을 선택하세요",connect_mobile_wallet:"모바일 지갑과 연결",scan_qrcode_with_wallet:"WalletConnect 지원 지갑에서 QR코드를 스캔하세요",connect:"연결",qrcode:"QR 코드",mobile:"모바일",desktop:"데스크탑",copy_to_clipboard:"클립보드에 복사",copied_to_clipboard:"클립보드에 복사되었습니다!",connect_with:"와 연결하다",loading:"로드 중...",something_went_wrong:"문제가 발생했습니다.",no_supported_wallets:"아직 지원되는 지갑이 없습니다",no_wallets_found:"지갑을 찾을 수 없습니다"},pt:{choose_preferred_wallet:"Escolha sua carteira preferida",connect_mobile_wallet:"Conectar-se à carteira móvel",scan_qrcode_with_wallet:"Ler o código QR com uma carteira compatível com WalletConnect",connect:"Conectar",qrcode:"Código QR",mobile:"Móvel",desktop:"Desktop",copy_to_clipboard:"Copiar",copied_to_clipboard:"Copiado!",connect_with:"Ligar por meio de",loading:"Carregamento...",something_went_wrong:"Algo correu mal",no_supported_wallets:"Ainda não há carteiras suportadas",no_wallets_found:"Nenhuma carteira encontrada"},zh:{choose_preferred_wallet:"选择你的钱包",connect_mobile_wallet:"连接至移动端钱包",scan_qrcode_with_wallet:"使用兼容 WalletConnect 的钱包扫描二维码",connect:"连接",qrcode:"二维码",mobile:"移动",desktop:"桌面",copy_to_clipboard:"复制到剪贴板",copied_to_clipboard:"复制到剪贴板成功！",connect_with:"通过以下方式连接",loading:"正在加载...",something_went_wrong:"出了问题",no_supported_wallets:"目前还没有支持的钱包",no_wallets_found:"没有找到钱包"},fa:{choose_preferred_wallet:"کیف پول مورد نظر خود را انتخاب کنید",connect_mobile_wallet:"به کیف پول موبایل وصل شوید",scan_qrcode_with_wallet:"کد QR را با یک کیف پول سازگار با WalletConnect اسکن کنید",connect:"اتصال",qrcode:"کد QR",mobile:"سیار",desktop:"دسکتاپ",copy_to_clipboard:"کپی به کلیپ بورد",copied_to_clipboard:"در کلیپ بورد کپی شد!",connect_with:"ارتباط با",loading:"...بارگذاری",something_went_wrong:"مشکلی پیش آمد",no_supported_wallets:"هنوز هیچ کیف پول پشتیبانی شده ای وجود ندارد",no_wallets_found:"هیچ کیف پولی پیدا نشد"}};function De(){var t=Re.getDocumentOrThrow(),e=t.getElementById("walletconnect-qrcode-modal");e&&(e.className=e.className.replace("fadeIn","fadeOut"),setTimeout((function(){var e=t.getElementById("walletconnect-wrapper");e&&t.body.removeChild(e)}),300))}function $e(t){return function(){De(),t&&t()}}function Ze(t,e,n){!function(){var t=Re.getDocumentOrThrow(),e=t.getElementById("walletconnect-style-sheet");e&&t.head.removeChild(e);var n=t.createElement("style");n.setAttribute("id","walletconnect-style-sheet"),n.innerText=':root {\n  --animation-duration: 300ms;\n}\n\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n\n@keyframes fadeOut {\n  from {\n    opacity: 1;\n  }\n  to {\n    opacity: 0;\n  }\n}\n\n.animated {\n  animation-duration: var(--animation-duration);\n  animation-fill-mode: both;\n}\n\n.fadeIn {\n  animation-name: fadeIn;\n}\n\n.fadeOut {\n  animation-name: fadeOut;\n}\n\n#walletconnect-wrapper {\n  -webkit-user-select: none;\n  align-items: center;\n  display: flex;\n  height: 100%;\n  justify-content: center;\n  left: 0;\n  pointer-events: none;\n  position: fixed;\n  top: 0;\n  user-select: none;\n  width: 100%;\n  z-index: 99999999999999;\n}\n\n.walletconnect-modal__headerLogo {\n  height: 21px;\n}\n\n.walletconnect-modal__header p {\n  color: #ffffff;\n  font-size: 20px;\n  font-weight: 600;\n  margin: 0;\n  align-items: flex-start;\n  display: flex;\n  flex: 1;\n  margin-left: 5px;\n}\n\n.walletconnect-modal__close__wrapper {\n  position: absolute;\n  top: 0px;\n  right: 0px;\n  z-index: 10000;\n  background: white;\n  border-radius: 26px;\n  padding: 6px;\n  box-sizing: border-box;\n  width: 26px;\n  height: 26px;\n  cursor: pointer;\n}\n\n.walletconnect-modal__close__icon {\n  position: relative;\n  top: 7px;\n  right: 0;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transform: rotate(45deg);\n}\n\n.walletconnect-modal__close__line1 {\n  position: absolute;\n  width: 100%;\n  border: 1px solid rgb(48, 52, 59);\n}\n\n.walletconnect-modal__close__line2 {\n  position: absolute;\n  width: 100%;\n  border: 1px solid rgb(48, 52, 59);\n  transform: rotate(90deg);\n}\n\n.walletconnect-qrcode__base {\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  background: rgba(37, 41, 46, 0.95);\n  height: 100%;\n  left: 0;\n  pointer-events: auto;\n  position: fixed;\n  top: 0;\n  transition: 0.4s cubic-bezier(0.19, 1, 0.22, 1);\n  width: 100%;\n  will-change: opacity;\n  padding: 40px;\n  box-sizing: border-box;\n}\n\n.walletconnect-qrcode__text {\n  color: rgba(60, 66, 82, 0.6);\n  font-size: 16px;\n  font-weight: 600;\n  letter-spacing: 0;\n  line-height: 1.1875em;\n  margin: 10px 0 20px 0;\n  text-align: center;\n  width: 100%;\n}\n\n@media only screen and (max-width: 768px) {\n  .walletconnect-qrcode__text {\n    font-size: 4vw;\n  }\n}\n\n@media only screen and (max-width: 320px) {\n  .walletconnect-qrcode__text {\n    font-size: 14px;\n  }\n}\n\n.walletconnect-qrcode__image {\n  width: calc(100% - 30px);\n  box-sizing: border-box;\n  cursor: none;\n  margin: 0 auto;\n}\n\n.walletconnect-qrcode__notification {\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  font-size: 16px;\n  padding: 16px 20px;\n  border-radius: 16px;\n  text-align: center;\n  transition: all 0.1s ease-in-out;\n  background: white;\n  color: black;\n  margin-bottom: -60px;\n  opacity: 0;\n}\n\n.walletconnect-qrcode__notification.notification__show {\n  opacity: 1;\n}\n\n@media only screen and (max-width: 768px) {\n  .walletconnect-modal__header {\n    height: 130px;\n  }\n  .walletconnect-modal__base {\n    overflow: auto;\n  }\n}\n\n@media only screen and (min-device-width: 415px) and (max-width: 768px) {\n  #content {\n    max-width: 768px;\n    box-sizing: border-box;\n  }\n}\n\n@media only screen and (min-width: 375px) and (max-width: 415px) {\n  #content {\n    max-width: 414px;\n    box-sizing: border-box;\n  }\n}\n\n@media only screen and (min-width: 320px) and (max-width: 375px) {\n  #content {\n    max-width: 375px;\n    box-sizing: border-box;\n  }\n}\n\n@media only screen and (max-width: 320px) {\n  #content {\n    max-width: 320px;\n    box-sizing: border-box;\n  }\n}\n\n.walletconnect-modal__base {\n  -webkit-font-smoothing: antialiased;\n  background: #ffffff;\n  border-radius: 24px;\n  box-shadow: 0 10px 50px 5px rgba(0, 0, 0, 0.4);\n  font-family: ui-rounded, "SF Pro Rounded", "SF Pro Text", medium-content-sans-serif-font,\n    -apple-system, BlinkMacSystemFont, ui-sans-serif, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell,\n    "Open Sans", "Helvetica Neue", sans-serif;\n  margin-top: 41px;\n  padding: 24px 24px 22px;\n  pointer-events: auto;\n  position: relative;\n  text-align: center;\n  transition: 0.4s cubic-bezier(0.19, 1, 0.22, 1);\n  will-change: transform;\n  overflow: visible;\n  transform: translateY(-50%);\n  top: 50%;\n  max-width: 500px;\n  margin: auto;\n}\n\n@media only screen and (max-width: 320px) {\n  .walletconnect-modal__base {\n    padding: 24px 12px;\n  }\n}\n\n.walletconnect-modal__base .hidden {\n  transform: translateY(150%);\n  transition: 0.125s cubic-bezier(0.4, 0, 1, 1);\n}\n\n.walletconnect-modal__header {\n  align-items: center;\n  display: flex;\n  height: 26px;\n  left: 0;\n  justify-content: space-between;\n  position: absolute;\n  top: -42px;\n  width: 100%;\n}\n\n.walletconnect-modal__base .wc-logo {\n  align-items: center;\n  display: flex;\n  height: 26px;\n  margin-top: 15px;\n  padding-bottom: 15px;\n  pointer-events: auto;\n}\n\n.walletconnect-modal__base .wc-logo div {\n  background-color: #3399ff;\n  height: 21px;\n  margin-right: 5px;\n  mask-image: url("images/wc-logo.svg") center no-repeat;\n  width: 32px;\n}\n\n.walletconnect-modal__base .wc-logo p {\n  color: #ffffff;\n  font-size: 20px;\n  font-weight: 600;\n  margin: 0;\n}\n\n.walletconnect-modal__base h2 {\n  color: rgba(60, 66, 82, 0.6);\n  font-size: 16px;\n  font-weight: 600;\n  letter-spacing: 0;\n  line-height: 1.1875em;\n  margin: 0 0 19px 0;\n  text-align: center;\n  width: 100%;\n}\n\n.walletconnect-modal__base__row {\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  align-items: center;\n  border-radius: 20px;\n  cursor: pointer;\n  display: flex;\n  height: 56px;\n  justify-content: space-between;\n  padding: 0 15px;\n  position: relative;\n  margin: 0px 0px 8px;\n  text-align: left;\n  transition: 0.15s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n  will-change: transform;\n  text-decoration: none;\n}\n\n.walletconnect-modal__base__row:hover {\n  background: rgba(60, 66, 82, 0.06);\n}\n\n.walletconnect-modal__base__row:active {\n  background: rgba(60, 66, 82, 0.06);\n  transform: scale(0.975);\n  transition: 0.1s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n}\n\n.walletconnect-modal__base__row__h3 {\n  color: #25292e;\n  font-size: 20px;\n  font-weight: 700;\n  margin: 0;\n  padding-bottom: 3px;\n}\n\n.walletconnect-modal__base__row__right {\n  align-items: center;\n  display: flex;\n  justify-content: center;\n}\n\n.walletconnect-modal__base__row__right__app-icon {\n  border-radius: 8px;\n  height: 34px;\n  margin: 0 11px 2px 0;\n  width: 34px;\n  background-size: 100%;\n  box-shadow: 0 4px 12px 0 rgba(37, 41, 46, 0.25);\n}\n\n.walletconnect-modal__base__row__right__caret {\n  height: 18px;\n  opacity: 0.3;\n  transition: 0.1s cubic-bezier(0.25, 0.46, 0.45, 0.94);\n  width: 8px;\n  will-change: opacity;\n}\n\n.walletconnect-modal__base__row:hover .caret,\n.walletconnect-modal__base__row:active .caret {\n  opacity: 0.6;\n}\n\n.walletconnect-modal__mobile__toggle {\n  width: 80%;\n  display: flex;\n  margin: 0 auto;\n  position: relative;\n  overflow: hidden;\n  border-radius: 8px;\n  margin-bottom: 18px;\n  background: #d4d5d9;\n}\n\n.walletconnect-modal__single_wallet {\n  display: flex;\n  justify-content: center;\n  margin-top: 7px;\n  margin-bottom: 18px;\n}\n\n.walletconnect-modal__single_wallet a {\n  cursor: pointer;\n  color: rgb(64, 153, 255);\n  font-size: 21px;\n  font-weight: 800;\n  text-decoration: none !important;\n  margin: 0 auto;\n}\n\n.walletconnect-modal__mobile__toggle_selector {\n  width: calc(50% - 8px);\n  background: white;\n  position: absolute;\n  border-radius: 5px;\n  height: calc(100% - 8px);\n  top: 4px;\n  transition: all 0.2s ease-in-out;\n  transform: translate3d(4px, 0, 0);\n}\n\n.walletconnect-modal__mobile__toggle.right__selected .walletconnect-modal__mobile__toggle_selector {\n  transform: translate3d(calc(100% + 12px), 0, 0);\n}\n\n.walletconnect-modal__mobile__toggle a {\n  font-size: 12px;\n  width: 50%;\n  text-align: center;\n  padding: 8px;\n  margin: 0;\n  font-weight: 600;\n  z-index: 1;\n}\n\n.walletconnect-modal__footer {\n  display: flex;\n  justify-content: center;\n  margin-top: 20px;\n}\n\n@media only screen and (max-width: 768px) {\n  .walletconnect-modal__footer {\n    margin-top: 5vw;\n  }\n}\n\n.walletconnect-modal__footer a {\n  cursor: pointer;\n  color: #898d97;\n  font-size: 15px;\n  margin: 0 auto;\n}\n\n@media only screen and (max-width: 320px) {\n  .walletconnect-modal__footer a {\n    font-size: 14px;\n  }\n}\n\n.walletconnect-connect__buttons__wrapper {\n  max-height: 44vh;\n}\n\n.walletconnect-connect__buttons__wrapper__android {\n  margin: 50% 0;\n}\n\n.walletconnect-connect__buttons__wrapper__wrap {\n  display: grid;\n  grid-template-columns: repeat(4, 1fr);\n  margin: 10px 0;\n}\n\n@media only screen and (min-width: 768px) {\n  .walletconnect-connect__buttons__wrapper__wrap {\n    margin-top: 40px;\n  }\n}\n\n.walletconnect-connect__button {\n  background-color: rgb(64, 153, 255);\n  padding: 12px;\n  border-radius: 8px;\n  text-decoration: none;\n  color: rgb(255, 255, 255);\n  font-weight: 500;\n}\n\n.walletconnect-connect__button__icon_anchor {\n  cursor: pointer;\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin: 8px;\n  width: 42px;\n  justify-self: center;\n  flex-direction: column;\n  text-decoration: none !important;\n}\n\n@media only screen and (max-width: 320px) {\n  .walletconnect-connect__button__icon_anchor {\n    margin: 4px;\n  }\n}\n\n.walletconnect-connect__button__icon {\n  border-radius: 10px;\n  height: 42px;\n  margin: 0;\n  width: 42px;\n  background-size: cover !important;\n  box-shadow: 0 4px 12px 0 rgba(37, 41, 46, 0.25);\n}\n\n.walletconnect-connect__button__text {\n  color: #424952;\n  font-size: 2.7vw;\n  text-decoration: none !important;\n  padding: 0;\n  margin-top: 1.8vw;\n  font-weight: 600;\n}\n\n@media only screen and (min-width: 768px) {\n  .walletconnect-connect__button__text {\n    font-size: 16px;\n    margin-top: 12px;\n  }\n}\n\n.walletconnect-search__input {\n  border: none;\n  background: #d4d5d9;\n  border-style: none;\n  padding: 8px 16px;\n  outline: none;\n  font-style: normal;\n  font-stretch: normal;\n  font-size: 16px;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: normal;\n  letter-spacing: normal;\n  text-align: left;\n  border-radius: 8px;\n  width: calc(100% - 16px);\n  margin: 0;\n  margin-bottom: 8px;\n}\n',t.head.appendChild(n)}();var i,r=function(){var t=Re.getDocumentOrThrow(),e=t.createElement("div");return e.setAttribute("id","walletconnect-wrapper"),t.body.appendChild(e),e}();Te.render(Te.createElement(Be,{text:(i=Re.getNavigatorOrThrow().language.split("-")[0]||"en",We[i]||We.en),uri:t,onClose:$e(e),qrcodeModalOptions:n}),r)}var Fe=function(){return"undefined"!=typeof process&&void 0!==process.versions&&void 0!==process.versions.node};var Qe={open:function(t,e,n){console.log(t),Fe()?function(t){Oe.toString(t,{type:"terminal"}).then(console.log)}(t):Ze(t,e,n)},close:function(){Fe()||De()}};class He extends O{constructor(t){super(),this.events=new r,this.accounts=[],this.chainId=1,this.pending=!1,this.bridge="https://bridge.walletconnect.org",this.qrcode=!0,this.qrcodeModalOptions=void 0,this.opts=t,this.chainId=(null==t?void 0:t.chainId)||this.chainId,this.wc=this.register(t)}get connected(){return void 0!==this.wc&&this.wc.connected}get connecting(){return this.pending}get connector(){return this.wc=this.register(this.opts),this.wc}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}off(t,e){this.events.off(t,e)}removeListener(t,e){this.events.removeListener(t,e)}async open(t){if(!this.connected)return new Promise(((e,n)=>{this.on("error",(t=>{n(t)})),this.on("open",(()=>{e()})),this.create(t)}));this.onOpen()}async close(){void 0!==this.wc&&(this.wc.connected&&this.wc.killSession(),this.onClose())}async send(t){this.wc=this.register(this.opts),this.connected||await this.open(),this.sendPayload(t).then((t=>this.events.emit("payload",t))).catch((e=>this.events.emit("payload",I(t.id,e.message))))}register(t){if(this.wc)return this.wc;this.opts=t||this.opts,this.bridge=(null==t?void 0:t.connector)?t.connector.bridge:(null==t?void 0:t.bridge)||"https://bridge.walletconnect.org",this.qrcode=void 0===(null==t?void 0:t.qrcode)||!1!==t.qrcode,this.chainId=void 0!==(null==t?void 0:t.chainId)?t.chainId:this.chainId,this.qrcodeModalOptions=null==t?void 0:t.qrcodeModalOptions;const e={bridge:this.bridge,qrcodeModal:this.qrcode?Qe:void 0,qrcodeModalOptions:this.qrcodeModalOptions,storageId:null==t?void 0:t.storageId,signingMethods:null==t?void 0:t.signingMethods,clientMeta:null==t?void 0:t.clientMeta};if(this.wc=void 0!==(null==t?void 0:t.connector)?t.connector:new Ie(e),void 0===this.wc)throw new Error("Failed to register WalletConnect connector");return this.wc.accounts.length&&(this.accounts=this.wc.accounts),this.wc.chainId&&(this.chainId=this.wc.chainId),this.registerConnectorEvents(),this.wc}onOpen(t){this.pending=!1,t&&(this.wc=t),this.events.emit("open")}onClose(){this.pending=!1,this.wc&&(this.wc=void 0),this.events.emit("close")}onError(t,e="Failed or Rejected Request",n=-32e3){const i={id:t.id,jsonrpc:t.jsonrpc,error:{code:n,message:e}};return this.events.emit("payload",i),i}create(t){this.wc=this.register(this.opts),this.chainId=t||this.chainId,this.connected||this.pending||(this.pending=!0,this.registerConnectorEvents(),this.wc.createSession({chainId:this.chainId}).then((()=>this.events.emit("created"))).catch((t=>this.events.emit("error",t))))}registerConnectorEvents(){this.wc=this.register(this.opts),this.wc.on("connect",(t=>{var e,n;t?this.events.emit("error",t):(this.accounts=(null===(e=this.wc)||void 0===e?void 0:e.accounts)||[],this.chainId=(null===(n=this.wc)||void 0===n?void 0:n.chainId)||this.chainId,this.onOpen())})),this.wc.on("disconnect",(t=>{t?this.events.emit("error",t):this.onClose()})),this.wc.on("modal_closed",(()=>{this.events.emit("error",new Error("User closed modal"))})),this.wc.on("session_update",((t,e)=>{const{accounts:n,chainId:i}=e.params[0];(!this.accounts||n&&this.accounts!==n)&&(this.accounts=n,this.events.emit("accountsChanged",n)),(!this.chainId||i&&this.chainId!==i)&&(this.chainId=i,this.events.emit("chainChanged",i))}))}async sendPayload(t){this.wc=this.register(this.opts);try{const e=await this.wc.unsafeSend(t);return this.sanitizeResponse(e)}catch(e){return this.onError(t,e.message)}}sanitizeResponse(t){return void 0!==t.error&&void 0===t.error.code?I(t.id,t.error.message):t}}class Je{constructor(t){this.events=new r,this.rpc={infuraId:null==t?void 0:t.infuraId,custom:null==t?void 0:t.rpc},this.signer=new j(new He(t));const e=this.signer.connection.chainId||(null==t?void 0:t.chainId)||1;this.http=this.setHttpProvider(e),this.registerEventListeners()}get connected(){return this.signer.connection.connected}get connector(){return this.signer.connection.connector}get accounts(){return this.signer.connection.accounts}get chainId(){return this.signer.connection.chainId}get rpcUrl(){var t;return(null===(t=this.http)||void 0===t?void 0:t.connection).url||""}async request(t){switch(t.method){case"eth_requestAccounts":return await this.connect(),this.signer.connection.accounts;case"eth_accounts":return this.signer.connection.accounts;case"eth_chainId":return this.signer.connection.chainId}if(At.includes(t.method))return this.signer.request(t);if(void 0===this.http)throw new Error(`Cannot request JSON-RPC method (${t.method}) without provided rpc url`);return this.http.request(t)}sendAsync(t,e){this.request(t).then((t=>e(null,t))).catch((t=>e(t,void 0)))}async enable(){return await this.request({method:"eth_requestAccounts"})}async connect(){this.signer.connection.connected||await this.signer.connect()}async disconnect(){this.signer.connection.connected&&await this.signer.disconnect()}on(t,e){this.events.on(t,e)}once(t,e){this.events.once(t,e)}removeListener(t,e){this.events.removeListener(t,e)}off(t,e){this.events.off(t,e)}get isWalletConnect(){return!0}registerEventListeners(){this.signer.connection.on("accountsChanged",(t=>{this.events.emit("accountsChanged",t)})),this.signer.connection.on("chainChanged",(t=>{this.http=this.setHttpProvider(t),this.events.emit("chainChanged",t)})),this.signer.on("disconnect",(()=>{this.events.emit("disconnect")}))}setHttpProvider(t){const e=ie(t,this.rpc);if(void 0===e)return;return new j(new B(e))}}export{Je as W};
