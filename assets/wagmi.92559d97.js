import{r}from"./react.49c1050d.js";import{g as e}from"./@ethersproject.8518e02e.js";import{I as t,b as n,C as o,S as a}from"./wagmi-core.18b92cca.js";function c(r,e,t){return e in r?Object.defineProperty(r,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[e]=t,r}function i(r,e){var t=Object.keys(r);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(r);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),t.push.apply(t,n)}return t}function d(r){for(var e=1;e<arguments.length;e++){var t=null!=arguments[e]?arguments[e]:{};e%2?i(Object(t),!0).forEach((function(e){c(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function s(r,e,t,n,o,a,c){try{var i=r[a](c),d=i.value}catch(s){return void t(s)}i.done?e(d):Promise.resolve(d).then(n,o)}function u(r){return function(){var e=this,t=arguments;return new Promise((function(n,o){var a=r.apply(e,t);function c(r){s(a,n,o,c,i,"next",r)}function i(r){s(a,n,o,c,i,"throw",r)}c(void 0)}))}}var l=()=>{var{state:r}=P();return r.provider},v=()=>P().state.cacheBuster,f=()=>{var e=r.exports.useRef(null);return r.exports.useEffect((()=>()=>{var r;return null===(r=e.current)||void 0===r?void 0:r.call(e)}),[]),r.exports.useCallback((r=>{var t;null===(t=e.current)||void 0===t||t.call(e),r&&(e.current=r)}),[])},p={loading:!1},g=function(){var{addressOrName:e,skip:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=v(),o=l(),[a,c]=r.exports.useState(p),i=f(),s=r.exports.useCallback(function(){var r=u((function*(r){var t=!1;i((()=>{t=!0}));try{var n=null!=r?r:{addressOrName:e};if(!n.addressOrName)throw new Error("addressOrName is required");c((r=>d(d({},r),{},{error:void 0,loading:!0})));var a=yield o.getAvatar(n.addressOrName);return t||c((r=>d(d({},r),{},{avatar:a,loading:!1}))),a}catch(u){var s=u;return t||c((r=>d(d({},r),{},{error:s,loading:!1}))),s}}));return function(e){return r.apply(this,arguments)}}(),[e,i,o]);return r.exports.useEffect((()=>{if(!t&&e)return s({addressOrName:e}),i}),[e,n,i,t]),[{data:a.avatar,loading:a.loading,error:a.error},s]},h={loading:!1},y=function(){var{address:e,skip:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=v(),o=l(),[a,c]=r.exports.useState(h),i=f(),s=r.exports.useCallback(function(){var r=u((function*(r){var t=!1;i((()=>{t=!0}));try{var n=null!=r?r:{address:e};if(!n.address)throw new Error("address is required");c((r=>d(d({},r),{},{error:void 0,loading:!0})));var a=yield o.lookupAddress(n.address);return t||c((r=>d(d({},r),{},{ens:a,loading:!1}))),{data:a,error:void 0}}catch(u){var s=u;return t||c((r=>d(d({},r),{},{error:s,loading:!1}))),{data:void 0,error:s}}}));return function(e){return r.apply(this,arguments)}}(),[e,i,o]);return r.exports.useEffect((()=>{if(!t&&e)return s({address:e}),i}),[e,n,i,t]),[{data:a.ens,loading:a.loading,error:a.error},s]},b=function(){var e,{fetchEns:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{state:n,setState:o}=P(),a=null===(e=n.data)||void 0===e?void 0:e.account,[{data:c,error:i,loading:d}]=y({address:a,skip:!t}),[{data:s,error:u,loading:l}]=g({addressOrName:c,skip:!t||!c}),v=r.exports.useCallback((()=>{o((r=>{var e;return null===(e=r.connector)||void 0===e||e.disconnect(),{cacheBuster:r.cacheBuster+1}}))}),[o]),f=i||u,p=d||l;return[{data:a?{address:a,connector:n.connector,ens:c?{avatar:s,name:c}:void 0}:void 0,error:f,loading:p},v]},m={loading:!1},x=()=>{var e,{state:t,setState:n,setLastUsedConnector:a}=P(),[c,i]=r.exports.useState(m),s=f(),l=r.exports.useCallback(function(){var r=u((function*(r){var e=!1;s((()=>{e=!0}));try{var c=null==t?void 0:t.connector;if(r===c)throw new o;i((e=>d(d({},e),{},{loading:!0,connector:r,error:void 0})));var u=yield r.connect();return e||(n((e=>d(d({},e),{},{connector:r,data:u}))),a(r.name),i((r=>d(d({},r),{},{loading:!1})))),{data:u,error:void 0}}catch(v){var l=v;return e||i((r=>d(d({},r),{},{connector:void 0,error:l,loading:!1}))),{data:void 0,error:l}}}));return function(e){return r.apply(this,arguments)}}(),[s,t.connector,n,a]);return r.exports.useEffect((()=>(i((r=>d(d({},r),{},{connector:t.connector,error:void 0}))),s)),[s,t.connector]),[{data:{connected:!(null===(e=t.data)||void 0===e||!e.account),connector:c.connector,connectors:t.connectors},error:c.error,loading:c.loading||t.connecting},l]},w={loading:!1},O=()=>{var e,t,o,{state:{connector:c,data:i}}=P(),[s,l]=r.exports.useState(w),v=null==i||null===(e=i.chain)||void 0===e?void 0:e.id,p=null==i||null===(t=i.chain)||void 0===t?void 0:t.unsupported,g=null!==(o=null==c?void 0:c.chains)&&void 0!==o?o:[],h=[...g,...n].find((r=>r.id===v)),y=f(),b=r.exports.useCallback(function(){var r=u((function*(r){var e=!1;if(y((()=>{e=!0})),null==c||!c.switchChain)return{data:void 0,error:new a};try{l((r=>d(d({},r),{},{error:void 0,loading:!0})));var t=yield c.switchChain(r);return e||l((r=>d(d({},r),{},{loading:!1}))),{data:t,error:void 0}}catch(o){var n=o;return e||l((r=>d(d({},r),{},{error:n,loading:!1}))),{data:void 0,error:n}}}));return function(e){return r.apply(this,arguments)}}(),[y,c]);return[{data:{chain:v?d(d({},h),{},{id:v,unsupported:p}):void 0,chains:g},error:s.error,loading:s.loading},null!=c&&c.switchChain?b:void 0]},S={data:void 0,error:void 0,loading:!1},k=function(){var{skip:e}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=v(),{state:{connector:n}}=P(),[o,a]=r.exports.useState(S),c=f(),i=r.exports.useCallback(u((function*(){var r=!1;c((()=>{r=!0}));try{a((r=>d(d({},r),{},{error:void 0,loading:!0})));var e=yield null==n?void 0:n.getSigner();return r||a((r=>d(d({},r),{},{data:e,loading:!1}))),e}catch(o){var t=o;r||a((r=>d(d({},r),{},{data:void 0,error:t,loading:!1})))}})),[c,n]);return r.exports.useEffect((()=>{if(!e)return i(),c}),[t,n,c,e]),[o,i]},C=r.exports.createContext(null),j=n=>{var o,a,c,i,s,l,{autoConnect:v=!1,children:f,connectors:p=[new t],connectorStorageKey:g="wagmi.wallet",provider:h=e(),webSocketProvider:y}=n,[b,m]=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,[n,o]=r.exports.useState((()=>{if("undefined"==typeof localStorage)return t;var r=localStorage.getItem(e);try{return r?JSON.parse(r):t}catch(n){return console.warn(n),t}})),a=r.exports.useCallback((r=>{if(r!==n)if(o(r),null===r?localStorage.removeItem(e):localStorage.setItem(e,JSON.stringify(r)),null===r)localStorage.removeItem(e);else try{localStorage.setItem(e,JSON.stringify(r))}catch(t){console.error(t)}}),[n,o,e]);return[n,a]}(g),[x,w]=r.exports.useState({cacheBuster:1,connecting:v}),O=r.exports.useMemo((()=>{var r,e;return"function"!=typeof p?p:p({chainId:null===(r=x.data)||void 0===r||null===(e=r.chain)||void 0===e?void 0:e.id})}),[p,null===(o=x.data)||void 0===o||null===(a=o.chain)||void 0===a?void 0:a.id]),S=r.exports.useMemo((()=>{var r,e;return"function"!=typeof h?h:h({chainId:null===(r=x.data)||void 0===r||null===(e=r.chain)||void 0===e?void 0:e.id,connector:x.connector})}),[h,null===(c=x.data)||void 0===c||null===(i=c.chain)||void 0===i?void 0:i.id,x.connector]),k=r.exports.useMemo((()=>{var r,e;if(y)return"function"!=typeof y?y:y({chainId:null===(r=x.data)||void 0===r||null===(e=r.chain)||void 0===e?void 0:e.id,connector:x.connector})}),[y,null===(s=x.data)||void 0===s||null===(l=s.chain)||void 0===l?void 0:l.id,x.connector]);r.exports.useEffect((()=>{v&&u((function*(){w((r=>d(d({},r),{},{connecting:!0})));var r=b?[...O].sort((r=>r.name===b?-1:1)):O,e=function*(r){if(!r.ready||!r.isAuthorized)return"continue";if(!(yield r.isAuthorized()))return"continue";var e=yield r.connect();return w((t=>d(d({},t),{},{connector:r,data:e}))),"break"};for(var t of r){var n=yield*e(t);if("continue"!==n&&"break"===n)break}w((r=>d(d({},r),{},{connecting:!1})))}))()}),[]),r.exports.useEffect((()=>()=>{x.connector&&x.connector.disconnect()}),[x.connector]),r.exports.useEffect((()=>{if(x.connector){var r=r=>w((e=>d(d({},e),{},{cacheBuster:e.cacheBuster+1,data:d(d({},e.data),r)}))),e=()=>w({cacheBuster:1}),t=r=>w((e=>d(d({},e),{},{error:r})));return x.connector.on("change",r),x.connector.on("disconnect",e),x.connector.on("error",t),()=>{x.connector&&(x.connector.off("change",r),x.connector.off("disconnect",e),x.connector.off("error",t))}}}),[x.connector]);var j={state:{cacheBuster:x.cacheBuster,connecting:x.connecting,connectors:O,connector:x.connector,data:x.data,provider:S,webSocketProvider:k},setState:w,setLastUsedConnector:m};return r.exports.createElement(C.Provider,{value:j},f)},P=()=>{var e=r.exports.useContext(C);if(!e)throw Error("Must be used within Provider");return e};export{j as P,k as a,b,O as c,x as d,l as u};
